
Marking local functions: mdns_send_probe mdns_handle_response mdns_handle_question mdns_announce mdns_send_outpacket mdns_init_outpacket mdns_add_txt_answer mdns_add_srv_answer mdns_add_servicename_ptr_answer mdns_add_servicetype_ptr_answer mdns_add_hostv6_ptr_answer mdns_add_aaaa_answer mdns_add_hostv4_ptr_answer mdns_add_a_answer mdns_read_answer mdns_read_question mdns_read_rr_info mdns_add_answer mdns_add_question mdns_write_domain check_service check_host mdns_build_service_domain mdns_build_dnssd_domain mdns_build_host_domain mdns_add_dotlocal mdns_build_reverse_v6_domain mdns_build_reverse_v4_domain mdns_prepare_txtdata mdns_domain_debug_print mdns_readname_loop mdns_domain_add_label_pbuf mdns_domain_add_label_base


Marking externally visible functions: mdns_resp_init mdns_resp_restart mdns_resp_register_name_result_cb mdns_resp_announce mdns_resp_add_service_txtitem mdns_resp_rename_service mdns_resp_del_service mdns_resp_add_service mdns_resp_rename_netif mdns_resp_remove_netif mdns_resp_add_netif mdns_compress_domain mdns_domain_eq mdns_readname mdns_domain_add_label


Marking externally visible variables:


Reclaiming functions:
Reclaiming variables:
Clearing address taken flags:
Symbol table:

pbuf_memcmp/90 (pbuf_memcmp) @06288380
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 
  Calls: 
netif_alloc_client_data_id/89 (netif_alloc_client_data_id) @062882a0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_init/57 
  Calls: 
udp_recv/88 (udp_recv) @062881c0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_init/57 
  Calls: 
ip_addr_any_type/87 (ip_addr_any_type) @06282990
  Type: variable
  Body removed by symtab_remove_unreachable_nodes
  Visibility: external public
  References: 
  Referring: mdns_resp_init/57 (addr)
  Availability: not_available
  Varpool flags: read-only
udp_bind/86 (udp_bind) @06288000
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_init/57 
  Calls: 
udp_new_ip_type/85 (udp_new_ip_type) @0626dee0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_init/57 
  Calls: 
rand/84 (rand) @0626dd20
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_restart/56 
  Calls: 
lwip_htonl/83 (lwip_htonl) @0621ca80
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_read_answer/29 mdns_add_answer/26 
  Calls: 
lwip_itoa/82 (lwip_itoa) @0621c7e0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_build_reverse_v4_domain/15 
  Calls: 
udp_sendto_if/81 (udp_sendto_if) @0621c540
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_send_outpacket/39 mdns_send_outpacket/39 
  Calls: 
pbuf_realloc/80 (pbuf_realloc) @0621c460
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: 
pbuf_take/79 (pbuf_take) @0621c380
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: 
pbuf_take_at/78 (pbuf_take_at) @06208e00
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_add_answer/26 mdns_add_answer/26 mdns_add_answer/26 mdns_write_domain/24 mdns_write_domain/24 mdns_add_question/25 mdns_add_question/25 
  Calls: 
lwip_htons/77 (lwip_htons) @06208d20
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 mdns_read_answer/29 mdns_read_rr_info/27 mdns_read_rr_info/27 mdns_recv/44 mdns_recv/44 mdns_recv/44 mdns_recv/44 mdns_recv/44 mdns_add_srv_answer/36 mdns_add_srv_answer/36 mdns_add_srv_answer/36 mdns_add_answer/26 mdns_send_outpacket/39 mdns_send_outpacket/39 mdns_send_outpacket/39 mdns_send_outpacket/39 mdns_send_outpacket/39 mdns_write_domain/24 mdns_add_question/25 mdns_add_question/25 
  Calls: 
pbuf_alloc/76 (pbuf_alloc) @06208c40
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_add_answer/26 mdns_add_question/25 
  Calls: 
pbuf_free/75 (pbuf_free) @062087e0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_handle_question/41 mdns_recv/44 mdns_send_outpacket/39 mdns_send_probe/45 
  Calls: 
sys_timeout/74 (sys_timeout) @06208380
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_restart/56 mdns_probe/46 
  Calls: 
ip6_addr_any/73 (ip6_addr_any) @06207900
  Type: variable
  Body removed by symtab_remove_unreachable_nodes
  Visibility: external public
  References: 
  Referring: mdns_probe/46 (addr)mdns_resp_announce/54 (addr)
  Availability: not_available
  Varpool flags: read-only
ip_addr_any/72 (ip_addr_any) @06207870
  Type: variable
  Body removed by symtab_remove_unreachable_nodes
  Visibility: external public
  References: 
  Referring: mdns_probe/46 (addr)mdns_resp_announce/54 (addr)
  Availability: not_available
  Varpool flags: read-only
mld6_leavegroup_netif/71 (mld6_leavegroup_netif) @062081c0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_remove_netif/48 
  Calls: 
igmp_leavegroup_netif/70 (igmp_leavegroup_netif) @062080e0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_remove_netif/48 
  Calls: 
sys_untimeout/69 (sys_untimeout) @06208000
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_handle_response/42 mdns_resp_restart/56 mdns_resp_remove_netif/48 
  Calls: 
mem_free/68 (mem_free) @05b32e00
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_del_service/51 mdns_resp_remove_netif/48 mdns_resp_remove_netif/48 mdns_resp_add_netif/47 
  Calls: 
mld6_joingroup_netif/67 (mld6_joingroup_netif) @05b32d20
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_add_netif/47 
  Calls: 
igmp_joingroup_netif/66 (igmp_joingroup_netif) @05b32c40
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_add_netif/47 
  Calls: 
mem_calloc/65 (mem_calloc) @05b32b60
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_add_service/50 mdns_resp_add_netif/47 
  Calls: 
strlen/64 (strlen) @05b32a80
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_resp_rename_service/52 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_rename_netif/49 mdns_build_dnssd_domain/19 mdns_build_reverse_v4_domain/15 mdns_build_service_domain/20 mdns_build_service_domain/20 mdns_build_service_domain/20 mdns_build_host_domain/18 mdns_resp_add_netif/47 mdns_resp_add_netif/47 mdns_resp_add_netif/47 
  Calls: 
memcmp/63 (memcmp) @05b328c0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_compress_domain/23 
  Calls: 
lwip_strnicmp/62 (lwip_strnicmp) @05b32700
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_domain_eq/13 
  Calls: 
pbuf_copy_partial/61 (pbuf_copy_partial) @05b32540
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 mdns_read_answer/29 mdns_read_answer/29 mdns_read_rr_info/27 mdns_read_rr_info/27 mdns_recv/44 mdns_domain_add_label_pbuf/9 
  Calls: 
pbuf_get_at/60 (pbuf_get_at) @05b32380
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_readname_loop/10 mdns_readname_loop/10 
  Calls: 
memset/59 (memset) @05b320e0
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_init_outpacket/38 mdns_read_answer/29 mdns_read_question/28 mdns_recv/44 mdns_announce/40 mdns_prepare_txtdata/14 mdns_build_dnssd_domain/19 mdns_build_reverse_v6_domain/16 mdns_build_reverse_v4_domain/15 mdns_send_outpacket/39 mdns_build_service_domain/20 mdns_build_host_domain/18 mdns_send_probe/45 mdns_readname/11 
  Calls: 
memcpy/58 (memcpy) @061f5700
  Type: function
  Visibility: external public
  References: 
  Referring: 
  Availability: not_available
  Function flags: optimize_size
  Called by: mdns_init_outpacket/38 mdns_recv/44 mdns_announce/40 mdns_resp_rename_service/52 mdns_resp_add_service/50 mdns_resp_add_service/50 mdns_resp_rename_netif/49 mdns_send_probe/45 mdns_resp_add_netif/47 mdns_domain_add_label/8 
  Calls: 
mdns_resp_init/57 (mdns_resp_init) @061f5d20
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_pcb/4 (write)mdns_pcb/4 (read)mdns_pcb/4 (read)mdns_pcb/4 (read)ip_addr_any_type/87 (addr)mdns_pcb/4 (read)mdns_recv/44 (addr)mdns_netif_client_id/3 (write)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: netif_alloc_client_data_id/89 udp_recv/88 udp_bind/86 udp_new_ip_type/85 
mdns_resp_restart/56 (mdns_resp_restart) @061f58c0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)mdns_probe/46 (addr)mdns_probe/46 (addr)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: mdns_resp_rename_service/52 mdns_resp_add_service/50 mdns_resp_rename_netif/49 mdns_resp_add_netif/47 
  Calls: sys_timeout/74 rand/84 sys_untimeout/69 
mdns_resp_register_name_result_cb/55 (mdns_resp_register_name_result_cb) @061f5620
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_name_result_cb/5 (write)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: 
mdns_resp_announce/54 (mdns_resp_announce) @061f5380
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)ip6_addr_any/73 (addr)ip_addr_any/72 (addr)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: mdns_probe/46 
  Calls: mdns_announce/40 mdns_announce/40 
mdns_resp_add_service_txtitem/53 (mdns_resp_add_service_txtitem) @061e6d20
  Type: function definition analyzed
  Visibility: externally_visible public
  References: 
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mdns_domain_add_label/8 
mdns_resp_rename_service/52 (mdns_resp_rename_service) @061e62a0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mdns_resp_restart/56 memcpy/58 strlen/64 
mdns_resp_del_service/51 (mdns_resp_del_service) @061e6c40
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mem_free/68 
mdns_resp_add_service/50 (mdns_resp_add_service) @061e68c0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mdns_resp_restart/56 memcpy/58 strlen/64 strlen/64 memcpy/58 strlen/64 strlen/64 mem_calloc/65 strlen/64 strlen/64 
mdns_resp_rename_netif/49 (mdns_resp_rename_netif) @061e6460
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mdns_resp_restart/56 memcpy/58 strlen/64 
mdns_resp_remove_netif/48 (mdns_resp_remove_netif) @061e61c0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)mdns_probe/46 (addr)v4group/1 (addr)v6group/2 (addr)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mem_free/68 mld6_leavegroup_netif/71 igmp_leavegroup_netif/70 mem_free/68 sys_untimeout/69 
mdns_resp_add_netif/47 (mdns_resp_add_netif) @061d68c0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: mdns_netif_client_id/3 (read)mdns_netif_client_id/3 (read)v4group/1 (addr)v6group/2 (addr)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: mem_free/68 mdns_resp_restart/56 mld6_joingroup_netif/67 igmp_joingroup_netif/66 memcpy/58 strlen/64 strlen/64 mem_calloc/65 strlen/64 
mdns_probe/46 (mdns_probe) @061d6c40
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  Address is taken.
  References: mdns_netif_client_id/3 (read)mdns_name_result_cb/5 (read)mdns_name_result_cb/5 (read)ip_addr_any/72 (addr)ip6_addr_any/73 (addr)mdns_probe/46 (addr)
  Referring: mdns_resp_remove_netif/48 (addr)mdns_probe/46 (addr)mdns_resp_restart/56 (addr)mdns_resp_restart/56 (addr)mdns_handle_response/42 (addr)
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: sys_timeout/74 mdns_send_probe/45 mdns_send_probe/45 mdns_resp_announce/54 
   Indirect call
mdns_send_probe/45 (mdns_send_probe) @061d67e0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_probe/46 mdns_probe/46 
  Calls: pbuf_free/75 mdns_send_outpacket/39 memcpy/58 mdns_add_question/25 mdns_build_service_domain/20 mdns_add_question/25 mdns_build_host_domain/18 memset/59 
mdns_recv/44 (mdns_recv) @061d61c0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  Address is taken.
  References: ip_data/43 (read)mdns_netif_client_id/3 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)ip_data/43 (read)
  Referring: mdns_resp_init/57 (addr)
  Availability: available
  Function flags: body optimize_size
  Called by: 
  Calls: pbuf_free/75 mdns_handle_question/41 mdns_handle_response/42 lwip_htons/77 lwip_htons/77 lwip_htons/77 lwip_htons/77 lwip_htons/77 memcpy/58 memset/59 pbuf_copy_partial/61 
ip_data/43 (ip_data) @06161990
  Type: variable
  Body removed by symtab_remove_unreachable_nodes
  Visibility: external public
  References: 
  Referring: mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)mdns_recv/44 (read)
  Availability: not_available
  Varpool flags:
mdns_handle_response/42 (mdns_handle_response) @061782a0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)mdns_probe/46 (addr)mdns_name_result_cb/5 (read)mdns_name_result_cb/5 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_recv/44 
  Calls: sys_untimeout/69 mdns_domain_eq/13 mdns_build_service_domain/20 mdns_domain_eq/13 mdns_build_host_domain/18 mdns_domain_debug_print/12 mdns_read_answer/29 mdns_read_question/28 
   Indirect call
mdns_handle_question/41 (mdns_handle_question) @0615fee0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_recv/44 
  Calls: pbuf_free/75 mdns_send_outpacket/39 pbuf_memcmp/90 mdns_prepare_txtdata/14 mdns_domain_eq/13 mdns_build_host_domain/18 mdns_readname/11 lwip_htons/77 pbuf_copy_partial/61 lwip_htons/77 pbuf_copy_partial/61 lwip_htons/77 pbuf_copy_partial/61 mdns_domain_eq/13 mdns_build_service_domain/20 mdns_domain_eq/13 mdns_build_service_domain/20 mdns_readname/11 check_service/22 pbuf_memcmp/90 pbuf_memcmp/90 mdns_domain_eq/13 mdns_build_host_domain/18 mdns_readname/11 check_host/21 mdns_domain_debug_print/12 mdns_read_answer/29 mdns_add_question/25 check_service/22 check_host/21 mdns_domain_debug_print/12 mdns_read_question/28 mdns_init_outpacket/38 
mdns_announce/40 (mdns_announce) @0615f8c0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_resp_announce/54 mdns_resp_announce/54 
  Calls: mdns_send_outpacket/39 memcpy/58 memset/59 
mdns_send_outpacket/39 (mdns_send_outpacket) @0615f2a0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)v6group/2 (addr)v4group/1 (addr)mdns_pcb/4 (read)mdns_pcb/4 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_announce/40 mdns_send_probe/45 
  Calls: pbuf_free/75 udp_sendto_if/81 udp_sendto_if/81 pbuf_realloc/80 pbuf_take/79 lwip_htons/77 lwip_htons/77 lwip_htons/77 lwip_htons/77 lwip_htons/77 memset/59 mdns_add_a_answer/30 mdns_add_aaaa_answer/32 mdns_add_txt_answer/37 mdns_add_srv_answer/36 mdns_add_txt_answer/37 mdns_add_srv_answer/36 mdns_add_servicename_ptr_answer/35 mdns_add_servicetype_ptr_answer/34 mdns_add_hostv6_ptr_answer/33 mdns_add_aaaa_answer/32 mdns_add_hostv4_ptr_answer/31 mdns_add_a_answer/30 
mdns_init_outpacket/38 (mdns_init_outpacket) @06153c40
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 
  Calls: memcpy/58 memset/59 
mdns_add_txt_answer/37 (mdns_add_txt_answer) @061538c0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_prepare_txtdata/14 mdns_build_service_domain/20 
mdns_add_srv_answer/36 (mdns_add_srv_answer) @06153620
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 lwip_htons/77 lwip_htons/77 lwip_htons/77 mdns_build_host_domain/18 mdns_build_service_domain/20 
mdns_add_servicename_ptr_answer/35 (mdns_add_servicename_ptr_answer) @06153380
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_service_domain/20 mdns_build_service_domain/20 
mdns_add_servicetype_ptr_answer/34 (mdns_add_servicetype_ptr_answer) @061530e0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_dnssd_domain/19 mdns_build_service_domain/20 
mdns_add_hostv6_ptr_answer/33 (mdns_add_hostv6_ptr_answer) @0614de00
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_reverse_v6_domain/16 mdns_build_host_domain/18 
mdns_add_aaaa_answer/32 (mdns_add_aaaa_answer) @0614d9a0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_host_domain/18 
mdns_add_hostv4_ptr_answer/31 (mdns_add_hostv4_ptr_answer) @0614d540
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_reverse_v4_domain/15 mdns_build_host_domain/18 
mdns_add_a_answer/30 (mdns_add_a_answer) @0614d0e0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_send_outpacket/39 mdns_send_outpacket/39 
  Calls: mdns_add_answer/26 mdns_build_host_domain/18 
mdns_read_answer/29 (mdns_read_answer) @0613ac40
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_handle_response/42 
  Calls: lwip_htons/77 pbuf_copy_partial/61 lwip_htonl/83 pbuf_copy_partial/61 mdns_read_rr_info/27 memset/59 
mdns_read_question/28 (mdns_read_question) @0613a9a0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_handle_response/42 
  Calls: mdns_read_rr_info/27 memset/59 
mdns_read_rr_info/27 (mdns_read_rr_info) @0613a700
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_read_answer/29 mdns_read_question/28 
  Calls: lwip_htons/77 pbuf_copy_partial/61 lwip_htons/77 pbuf_copy_partial/61 mdns_readname/11 
mdns_add_answer/26 (mdns_add_answer) @0613a460
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_add_a_answer/30 mdns_add_aaaa_answer/32 mdns_add_txt_answer/37 mdns_add_srv_answer/36 mdns_add_servicename_ptr_answer/35 mdns_add_servicetype_ptr_answer/34 mdns_add_hostv6_ptr_answer/33 mdns_add_hostv4_ptr_answer/31 
  Calls: pbuf_take_at/78 lwip_htons/77 mdns_write_domain/24 pbuf_take_at/78 pbuf_take_at/78 lwip_htonl/83 mdns_add_question/25 pbuf_alloc/76 
mdns_add_question/25 (mdns_add_question) @0613a1c0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_add_answer/26 mdns_send_probe/45 mdns_send_probe/45 
  Calls: pbuf_take_at/78 lwip_htons/77 pbuf_take_at/78 lwip_htons/77 mdns_write_domain/24 pbuf_alloc/76 
mdns_write_domain/24 (mdns_write_domain) @0612cb60
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_add_answer/26 mdns_add_question/25 
  Calls: pbuf_take_at/78 lwip_htons/77 pbuf_take_at/78 mdns_compress_domain/23 
mdns_compress_domain/23 (mdns_compress_domain) @0612cd20
  Type: function definition analyzed
  Visibility: externally_visible public
  References: 
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: mdns_write_domain/24 
  Calls: memcmp/63 mdns_readname/11 
check_service/22 (check_service) @0612ca80
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 
  Calls: mdns_domain_eq/13 mdns_build_service_domain/20 mdns_domain_eq/13 mdns_build_service_domain/20 mdns_domain_eq/13 mdns_build_dnssd_domain/19 
check_host/21 (check_host) @0612c7e0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: mdns_netif_client_id/3 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 
  Calls: mdns_domain_eq/13 mdns_build_host_domain/18 mdns_domain_eq/13 mdns_build_reverse_v4_domain/15 mdns_domain_eq/13 mdns_build_reverse_v6_domain/16 
mdns_build_service_domain/20 (mdns_build_service_domain) @06123d20
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: dnssd_protos/6 (read)dnssd_protos/6 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: check_service/22 check_service/22 mdns_handle_question/41 mdns_handle_question/41 mdns_handle_response/42 mdns_add_txt_answer/37 mdns_add_srv_answer/36 mdns_add_servicename_ptr_answer/35 mdns_add_servicename_ptr_answer/35 mdns_add_servicetype_ptr_answer/34 mdns_send_probe/45 
  Calls: mdns_add_dotlocal/17 mdns_domain_add_label/8 strlen/64 mdns_domain_add_label/8 strlen/64 mdns_domain_add_label/8 strlen/64 memset/59 
mdns_build_dnssd_domain/19 (mdns_build_dnssd_domain) @061237e0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: dnssd_protos/6 (read)dnssd_protos/6 (read)
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: check_service/22 mdns_add_servicetype_ptr_answer/34 
  Calls: mdns_add_dotlocal/17 mdns_domain_add_label/8 strlen/64 mdns_domain_add_label/8 mdns_domain_add_label/8 memset/59 
mdns_build_host_domain/18 (mdns_build_host_domain) @061232a0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: check_host/21 mdns_handle_question/41 mdns_handle_question/41 mdns_handle_response/42 mdns_add_a_answer/30 mdns_add_aaaa_answer/32 mdns_add_srv_answer/36 mdns_add_hostv6_ptr_answer/33 mdns_add_hostv4_ptr_answer/31 mdns_send_probe/45 
  Calls: mdns_add_dotlocal/17 mdns_domain_add_label/8 strlen/64 memset/59 
mdns_add_dotlocal/17 (mdns_add_dotlocal) @0611aee0
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_build_dnssd_domain/19 mdns_build_service_domain/20 mdns_build_host_domain/18 
  Calls: mdns_domain_add_label/8 mdns_domain_add_label/8 
mdns_build_reverse_v6_domain/16 (mdns_build_reverse_v6_domain) @0611ab60
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: check_host/21 mdns_add_hostv6_ptr_answer/33 
  Calls: mdns_domain_add_label/8 mdns_domain_add_label/8 mdns_domain_add_label/8 mdns_domain_add_label/8 memset/59 
mdns_build_reverse_v4_domain/15 (mdns_build_reverse_v4_domain) @0611a540
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: check_host/21 mdns_add_hostv4_ptr_answer/31 
  Calls: mdns_domain_add_label/8 mdns_domain_add_label/8 mdns_domain_add_label/8 mdns_domain_add_label/8 strlen/64 lwip_itoa/82 memset/59 
mdns_prepare_txtdata/14 (mdns_prepare_txtdata) @0610fc40
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_add_txt_answer/37 
  Calls: memset/59 
   Indirect call
mdns_domain_eq/13 (mdns_domain_eq) @0610fe00
  Type: function definition analyzed
  Visibility: externally_visible public
  References: 
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: check_service/22 check_service/22 check_service/22 check_host/21 check_host/21 check_host/21 mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 mdns_handle_response/42 mdns_handle_response/42 
  Calls: lwip_strnicmp/62 
mdns_domain_debug_print/12 (mdns_domain_debug_print) @0610fb60
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 mdns_handle_response/42 
  Calls: 
mdns_readname/11 (mdns_readname) @0610f8c0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: 
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: mdns_handle_question/41 mdns_handle_question/41 mdns_handle_question/41 mdns_read_rr_info/27 mdns_compress_domain/23 
  Calls: mdns_readname_loop/10 memset/59 
mdns_readname_loop/10 (mdns_readname_loop) @0610f620
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_readname_loop/10 mdns_readname/11 
  Calls: mdns_domain_add_label_pbuf/9 mdns_readname_loop/10 pbuf_get_at/60 pbuf_get_at/60 
mdns_domain_add_label_pbuf/9 (mdns_domain_add_label_pbuf) @0610f380
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_readname_loop/10 
  Calls: pbuf_copy_partial/61 mdns_domain_add_label_base/7 
mdns_domain_add_label/8 (mdns_domain_add_label) @0610f0e0
  Type: function definition analyzed
  Visibility: externally_visible public
  References: 
  Referring: 
  Availability: available
  Function flags: body optimize_size
  Called by: mdns_resp_add_service_txtitem/53 mdns_build_dnssd_domain/19 mdns_build_dnssd_domain/19 mdns_build_dnssd_domain/19 mdns_build_reverse_v6_domain/16 mdns_build_reverse_v6_domain/16 mdns_build_reverse_v6_domain/16 mdns_build_reverse_v6_domain/16 mdns_build_reverse_v4_domain/15 mdns_build_reverse_v4_domain/15 mdns_build_reverse_v4_domain/15 mdns_build_reverse_v4_domain/15 mdns_build_service_domain/20 mdns_build_service_domain/20 mdns_build_service_domain/20 mdns_add_dotlocal/17 mdns_add_dotlocal/17 mdns_build_host_domain/18 
  Calls: memcpy/58 mdns_domain_add_label_base/7 
mdns_domain_add_label_base/7 (mdns_domain_add_label_base) @06109e00
  Type: function definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: 
  Availability: local
  Function flags: body local optimize_size
  Called by: mdns_domain_add_label_pbuf/9 mdns_domain_add_label/8 
  Calls: 
dnssd_protos/6 (dnssd_protos) @061011f8
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_build_service_domain/20 (read)mdns_build_service_domain/20 (read)mdns_build_dnssd_domain/19 (read)mdns_build_dnssd_domain/19 (read)
  Availability: available
  Varpool flags: initialized
mdns_name_result_cb/5 (mdns_name_result_cb) @060b4af8
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_probe/46 (read)mdns_probe/46 (read)mdns_resp_register_name_result_cb/55 (write)mdns_handle_response/42 (read)mdns_handle_response/42 (read)
  Availability: available
  Varpool flags:
mdns_pcb/4 (mdns_pcb) @060b4a20
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_send_outpacket/39 (read)mdns_send_outpacket/39 (read)mdns_resp_init/57 (write)mdns_resp_init/57 (read)mdns_resp_init/57 (read)mdns_resp_init/57 (read)mdns_resp_init/57 (read)
  Availability: available
  Varpool flags:
mdns_netif_client_id/3 (mdns_netif_client_id) @060b4990
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_resp_add_netif/47 (read)mdns_resp_add_netif/47 (read)mdns_resp_add_netif/47 (read)mdns_resp_remove_netif/48 (read)mdns_resp_remove_netif/48 (read)mdns_probe/46 (read)mdns_send_probe/45 (read)mdns_send_outpacket/39 (read)mdns_add_hostv4_ptr_answer/31 (read)mdns_add_hostv4_ptr_answer/31 (read)mdns_add_hostv6_ptr_answer/33 (read)mdns_add_hostv6_ptr_answer/33 (read)mdns_add_aaaa_answer/32 (read)mdns_add_aaaa_answer/32 (read)mdns_add_a_answer/30 (read)mdns_add_a_answer/30 (read)mdns_resp_rename_netif/49 (read)mdns_resp_add_service/50 (read)mdns_resp_del_service/51 (read)mdns_resp_rename_service/52 (read)mdns_resp_announce/54 (read)mdns_announce/40 (read)mdns_resp_restart/56 (read)mdns_resp_init/57 (write)mdns_recv/44 (read)mdns_handle_response/42 (read)mdns_handle_question/41 (read)check_host/21 (read)
  Availability: available
  Varpool flags:
v6group/2 (v6group) @060b47e0
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_resp_add_netif/47 (addr)mdns_resp_remove_netif/48 (addr)mdns_send_outpacket/39 (addr)
  Availability: available
  Varpool flags: initialized read-only const-value-known
v4group/1 (v4group) @05ebf2d0
  Type: variable definition analyzed
  Visibility: prevailing_def_ironly
  References: 
  Referring: mdns_resp_add_netif/47 (addr)mdns_resp_remove_netif/48 (addr)mdns_send_outpacket/39 (addr)
  Availability: available
  Varpool flags: initialized read-only const-value-known
mdns_resp_init ()
{
  err_t res;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = udp_new_ip_type (46);
  mdns_pcb = _1;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_pcb.49_2 = mdns_pcb;
  if (mdns_pcb.49_2 == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_pcb.50_3 = mdns_pcb;
  mdns_pcb.50_3->mcast_ttl = 255;
  # DEBUG BEGIN_STMT
  mdns_pcb.51_4 = mdns_pcb;
  res = udp_bind (mdns_pcb.51_4, &ip_addr_any_type, 5353);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 5>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_pcb.52_5 = mdns_pcb;
  udp_recv (mdns_pcb.52_5, mdns_recv, 0B);
  # DEBUG BEGIN_STMT
  _6 = netif_alloc_client_data_id ();
  mdns_netif_client_id = _6;
  return;

}


mdns_resp_restart (struct netif * netif)
{
  struct mdns_host * mdns;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.48_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.48_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _3 = mdns->probing_state;
  if (_3 == 1)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  sys_untimeout (mdns_probe, netif);

  <bb 8> :
  # DEBUG BEGIN_STMT
  mdns->probes_sent = 0;
  # DEBUG BEGIN_STMT
  mdns->probing_state = 1;
  # DEBUG BEGIN_STMT
  _4 = rand ();
  _5 = (long unsigned int) _4;
  _6 = _5 % 250;
  sys_timeout (_6, mdns_probe, netif);

  <bb 9> :
  return;

}


mdns_resp_register_name_result_cb (void (*mdns_name_result_cb_t) (struct netif *, u8_t) cb)
{
  <bb 2> :
  # DEBUG BEGIN_STMT
  mdns_name_result_cb = cb;
  return;

}


mdns_resp_announce (struct netif * netif)
{
  struct mdns_host * mdns;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.46_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.46_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _3 = mdns->probing_state;
  if (_3 == 2)
    goto <bb 7>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  mdns_announce (netif, &ip6_addr_any);
  # DEBUG BEGIN_STMT
  _4 = &netif->ip_addr.u_addr.ip4;
  _5 = MEM[(const struct ip4_addr_t *)_4].addr;
  if (_5 != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  mdns_announce (netif, &ip_addr_any);

  <bb 9> :
  return;

}


mdns_resp_add_service_txtitem (struct mdns_service * service, const char * txt, u8_t txt_len)
{
  err_t D.8299;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = &service->txtdata;
  D.8299 = mdns_domain_add_label (_1, txt, txt_len);
  return D.8299;

}


mdns_resp_rename_service (struct netif * netif, s8_t slot, const char * name)
{
  size_t len;
  struct mdns_host * mdns;
  struct mdns_service * srv;
  err_t D.8289;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  len = strlen (name);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.45_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.45_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8289 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 13>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (len > 63)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8289 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 13>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (slot != 0)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.8289 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 13>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = (int) slot;
  _4 = mdns->services[_3];
  if (_4 == 0B)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8289 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 13>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = (int) slot;
  srv = mdns->services[_5];
  # DEBUG BEGIN_STMT
  _6 = &srv->name;
  _7 = MIN_EXPR <len, 63>;
  memcpy (_6, name, _7);
  # DEBUG BEGIN_STMT
  srv->name[len] = 0;
  # DEBUG BEGIN_STMT
  mdns_resp_restart (netif);
  # DEBUG BEGIN_STMT
  D.8289 = 0;

  <bb 13> :
  return D.8289;

}


mdns_resp_del_service (struct netif * netif, s8_t slot)
{
  struct mdns_service * srv;
  struct mdns_host * mdns;
  err_t D.8279;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.44_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.44_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8279 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (slot != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8279 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = (int) slot;
  _4 = mdns->services[_3];
  if (_4 == 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.8279 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = (int) slot;
  srv = mdns->services[_5];
  # DEBUG BEGIN_STMT
  _6 = (int) slot;
  mdns->services[_6] = 0B;
  # DEBUG BEGIN_STMT
  mem_free (srv);
  # DEBUG BEGIN_STMT
  D.8279 = 0;

  <bb 11> :
  return D.8279;

}


mdns_resp_add_service (struct netif * netif, const char * name, const char * service, mdns_sd_proto proto, u16_t port, u32_t dns_ttl, void (*service_get_txt_fn_t) (struct mdns_service *, void *) txt_fn, void * txt_data)
{
  struct mdns_host * mdns;
  struct mdns_service * srv;
  s8_t slot;
  s8_t i;
  size_t iftmp.43;
  size_t iftmp.42;
  s8_t D.8253;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  slot = -1;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.39_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.39_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8253 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = strlen (name);
  if (_3 > 63)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8253 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _4 = strlen (service);
  if (_4 > 63)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.8253 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (proto > 1)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8253 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 16>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  _5 = (int) i;
  _6 = mdns->services[_5];
  if (_6 == 0B)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  slot = i;
  # DEBUG BEGIN_STMT
  goto <bb 17>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  i.40_7 = i;
  i.41_8 = (unsigned char) i.40_7;
  _9 = i.41_8 + 1;
  i = (s8_t) _9;

  <bb 16> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 13>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (slot < 0)
    goto <bb 18>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  D.8253 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  srv = mem_calloc (1, 404);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (srv == 0B)
    goto <bb 20>; [INV]
  else
    goto <bb 21>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  D.8253 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 28>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _10 = &srv->name;
  _11 = strlen (name);
  if (_11 <= 63)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  iftmp.42 = strlen (name);
  goto <bb 24>; [INV]

  <bb 23> :
  iftmp.42 = 63;

  <bb 24> :
  memcpy (_10, name, iftmp.42);
  # DEBUG BEGIN_STMT
  _12 = &srv->service;
  _13 = strlen (service);
  if (_13 <= 63)
    goto <bb 25>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 25> :
  iftmp.43 = strlen (service);
  goto <bb 27>; [INV]

  <bb 26> :
  iftmp.43 = 63;

  <bb 27> :
  memcpy (_12, service, iftmp.43);
  # DEBUG BEGIN_STMT
  srv->txt_fn = txt_fn;
  # DEBUG BEGIN_STMT
  srv->txt_userdata = txt_data;
  # DEBUG BEGIN_STMT
  _14 = (short unsigned int) proto;
  srv->proto = _14;
  # DEBUG BEGIN_STMT
  srv->port = port;
  # DEBUG BEGIN_STMT
  srv->dns_ttl = dns_ttl;
  # DEBUG BEGIN_STMT
  _15 = (int) slot;
  mdns->services[_15] = srv;
  # DEBUG BEGIN_STMT
  mdns_resp_restart (netif);
  # DEBUG BEGIN_STMT
  D.8253 = slot;

  <bb 28> :
  return D.8253;

}


mdns_resp_rename_netif (struct netif * netif, const char * hostname)
{
  size_t len;
  struct mdns_host * mdns;
  err_t D.8243;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  len = strlen (hostname);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8243 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (len > 63)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8243 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.38_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.38_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8243 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = &mdns->name;
  _4 = MIN_EXPR <len, 63>;
  memcpy (_3, hostname, _4);
  # DEBUG BEGIN_STMT
  mdns->name[len] = 0;
  # DEBUG BEGIN_STMT
  mdns_resp_restart (netif);
  # DEBUG BEGIN_STMT
  D.8243 = 0;

  <bb 9> :
  return D.8243;

}


mdns_resp_remove_netif (struct netif * netif)
{
  struct mdns_service * service;
  struct mdns_host * mdns;
  int i;
  err_t D.7979;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 3>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.6_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.6_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.7979 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = mdns->probing_state;
  if (_3 == 1)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  sys_untimeout (mdns_probe, netif);

  <bb 8> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 12>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  service = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (service != 0B)
    goto <bb 10>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  mem_free (service);

  <bb 11> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 12> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 9>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  igmp_leavegroup_netif (netif, &v4group.u_addr.ip4);
  # DEBUG BEGIN_STMT
  mld6_leavegroup_netif (netif, &v6group.u_addr.ip6);
  # DEBUG BEGIN_STMT
  mem_free (mdns);
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.7_4 = mdns_netif_client_id;
  _5 = (int) mdns_netif_client_id.7_4;
  netif->client_data[_5] = 0B;
  # DEBUG BEGIN_STMT
  D.7979 = 0;

  <bb 14> :
  return D.7979;

}


mdns_resp_add_netif (struct netif * netif, const char * hostname, u32_t dns_ttl)
{
  struct mdns_host * mdns;
  err_t res;
  size_t iftmp.4;
  err_t D.7959;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (netif == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7959 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 19>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = strlen (hostname);
  if (_1 > 63)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.7959 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 19>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.2_2 = mdns_netif_client_id;
  _3 = (int) mdns_netif_client_id.2_2;
  _4 = netif->client_data[_3];
  if (_4 != 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  __asm__ __volatile__("BKPT #0
	");
  # DEBUG BEGIN_STMT
  goto <bb 7>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns = mem_calloc (1, 76);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.7959 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 19>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.3_5 = mdns_netif_client_id;
  _6 = (int) mdns_netif_client_id.3_5;
  netif->client_data[_6] = mdns;
  # DEBUG BEGIN_STMT
  _7 = &mdns->name;
  _8 = strlen (hostname);
  if (_8 <= 63)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  iftmp.4 = strlen (hostname);
  goto <bb 13>; [INV]

  <bb 12> :
  iftmp.4 = 63;

  <bb 13> :
  memcpy (_7, hostname, iftmp.4);
  # DEBUG BEGIN_STMT
  mdns->dns_ttl = dns_ttl;
  # DEBUG BEGIN_STMT
  mdns->probes_sent = 0;
  # DEBUG BEGIN_STMT
  mdns->probing_state = 0;
  # DEBUG BEGIN_STMT
  res = igmp_joingroup_netif (netif, &v4group.u_addr.ip4);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 18>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  res = mld6_joingroup_netif (netif, &v6group.u_addr.ip6);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 18>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  mdns_resp_restart (netif);
  # DEBUG BEGIN_STMT
  D.7959 = 0;
  goto <bb 19>; [INV]

  <bb 18> :
cleanup:
  # DEBUG BEGIN_STMT
  mem_free (mdns);
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.5_9 = mdns_netif_client_id;
  _10 = (int) mdns_netif_client_id.5_9;
  netif->client_data[_10] = 0B;
  # DEBUG BEGIN_STMT
  D.7959 = res;

  <bb 19> :
  return D.7959;

}


mdns_probe (void * arg)
{
  struct mdns_host * mdns;
  struct netif * netif;

  <bb 2> :
  # DEBUG BEGIN_STMT
  netif = arg;
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.8_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.8_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  _3 = mdns->probes_sent;
  if (_3 > 2)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  mdns->probing_state = 2;
  # DEBUG BEGIN_STMT
  mdns_resp_announce (netif);
  # DEBUG BEGIN_STMT
  mdns_name_result_cb.9_4 = mdns_name_result_cb;
  if (mdns_name_result_cb.9_4 != 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  mdns_name_result_cb.10_5 = mdns_name_result_cb;
  mdns_name_result_cb.10_5 (netif, 1);
  goto <bb 10>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _6 = &netif->ip_addr.u_addr.ip4;
  _7 = MEM[(const struct ip4_addr_t *)_6].addr;
  if (_7 != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 6> :
  _8 = mdns_send_probe (netif, &ip_addr_any);
  if (_8 == 0)
    goto <bb 7>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _9 = mdns_send_probe (netif, &ip6_addr_any);
  if (_9 == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  _10 = mdns->probes_sent;
  _11 = _10;
  _12 = _11 + 1;
  mdns->probes_sent = _12;

  <bb 9> :
  # DEBUG BEGIN_STMT
  sys_timeout (250, mdns_probe, netif);

  <bb 10> :
  return;

}


mdns_send_probe (struct netif * netif, const struct ip_addr_t * destination)
{
  struct mdns_service * serv;
  struct mdns_service * service;
  err_t res;
  u8_t i;
  struct mdns_domain domain;
  struct mdns_outpacket pkt;
  struct mdns_host * mdns;
  err_t D.8010;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.11_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.11_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  memset (&pkt, 0, 72);
  # DEBUG BEGIN_STMT
  pkt.netif = netif;
  # DEBUG BEGIN_STMT
  mdns_build_host_domain (&domain, mdns);
  # DEBUG BEGIN_STMT
  res = mdns_add_question (&pkt, &domain, 255, 1, 1);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 25>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _3 = pkt.questions;
  _4 = _3;
  _5 = _4 + 1;
  pkt.questions = _5;
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 11>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _6 = (int) i;
  service = mdns->services[_6];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 10>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&domain, service, 1);
  # DEBUG BEGIN_STMT
  res = mdns_add_question (&pkt, &domain, 255, 1, 1);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 25>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _7 = pkt.questions;
  _8 = _7;
  _9 = _8 + 1;
  pkt.questions = _9;

  <bb 10> :
  # DEBUG BEGIN_STMT
  i.12_10 = i;
  i = i.12_10 + 1;

  <bb 11> :
  # DEBUG BEGIN_STMT
  if (i == 0)
    goto <bb 5>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  _11 = &netif->ip_addr.u_addr.ip4;
  _12 = MEM[(const struct ip4_addr_t *)_11].addr;
  if (_12 != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  pkt.host_replies = 1;

  <bb 14> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 18>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  _13 = (int) i;
  _14 = netif->ip6_addr_state[_13];
  _15 = (int) _14;
  _16 = _15 & 16;
  if (_16 != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  _17 = pkt.host_replies;
  _18 = _17 | 4;
  pkt.host_replies = _18;

  <bb 17> :
  # DEBUG BEGIN_STMT
  i.13_19 = i;
  i = i.13_19 + 1;

  <bb 18> :
  # DEBUG BEGIN_STMT
  if (i <= 2)
    goto <bb 15>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 23>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  _20 = (int) i;
  serv = mdns->services[_20];
  # DEBUG BEGIN_STMT
  if (serv != 0B)
    goto <bb 21>; [INV]
  else
    goto <bb 22>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  _21 = (int) i;
  pkt.serv_replies[_21] = 192;

  <bb 22> :
  # DEBUG BEGIN_STMT
  i.14_22 = i;
  i = i.14_22 + 1;

  <bb 23> :
  # DEBUG BEGIN_STMT
  if (i == 0)
    goto <bb 20>; [INV]
  else
    goto <bb 24>; [INV]

  <bb 24> :
  # DEBUG BEGIN_STMT
  pkt.tx_id = 0;
  # DEBUG BEGIN_STMT
  pkt.dest_port = 5353;
  # DEBUG BEGIN_STMT
  memcpy (&pkt.dest_addr, destination, 24);
  # DEBUG BEGIN_STMT
  res = mdns_send_outpacket (&pkt, 0);

  <bb 25> :
cleanup:
  # DEBUG BEGIN_STMT
  _23 = pkt.pbuf;
  if (_23 != 0B)
    goto <bb 26>; [INV]
  else
    goto <bb 27>; [INV]

  <bb 26> :
  # DEBUG BEGIN_STMT
  _24 = pkt.pbuf;
  pbuf_free (_24);
  # DEBUG BEGIN_STMT
  pkt.pbuf = 0B;

  <bb 27> :
  # DEBUG BEGIN_STMT
  D.8010 = res;
  pkt = {CLOBBER};
  domain = {CLOBBER};
  return D.8010;

}


mdns_recv (void * arg, struct udp_pcb * pcb, struct pbuf * p, const struct ip_addr_t * addr, u16_t port)
{
  u16_t offset;
  struct netif * recv_netif;
  struct mdns_packet packet;
  struct dns_hdr hdr;
  int iftmp.59;
  _Bool iftmp.58;
  _Bool iftmp.57;
  int iftmp.56;
  _Bool iftmp.55;
  _Bool iftmp.54;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  recv_netif = ip_data.current_input_netif;
  # DEBUG BEGIN_STMT
  offset = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.53_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.53_1;
  _3 = recv_netif->client_data[_2];
  if (_3 == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 42>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _4 = pbuf_copy_partial (p, &hdr, 12, offset);
  if (_4 <= 11)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 42>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  offset = offset + 12;
  # DEBUG BEGIN_STMT
  _5 = hdr.flags1;
  _6 = _5 >> 3;
  _7 = (int) _6;
  _8 = _7 & 15;
  if (_8 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 42>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  memset (&packet, 0, 48);
  # DEBUG BEGIN_STMT
  memcpy (&packet.source_addr, addr, 24);
  # DEBUG BEGIN_STMT
  packet.source_port = port;
  # DEBUG BEGIN_STMT
  packet.netif = recv_netif;
  # DEBUG BEGIN_STMT
  packet.pbuf = p;
  # DEBUG BEGIN_STMT
  packet.parse_offset = offset;
  # DEBUG BEGIN_STMT
  _9 = hdr.id;
  _10 = lwip_htons (_9);
  packet.tx_id = _10;
  # DEBUG BEGIN_STMT
  _11 = hdr.numquestions;
  _12 = lwip_htons (_11);
  packet.questions_left = _12;
  _13 = packet.questions_left;
  packet.questions = _13;
  # DEBUG BEGIN_STMT
  _14 = hdr.numanswers;
  _15 = lwip_htons (_14);
  _16 = hdr.numauthrr;
  _17 = lwip_htons (_16);
  _18 = _15 + _17;
  _19 = hdr.numextrarr;
  _20 = lwip_htons (_19);
  _21 = _18 + _20;
  packet.answers_left = _21;
  _22 = packet.answers_left;
  packet.answers = _22;
  # DEBUG BEGIN_STMT
  _23 = ip_data.current_iphdr_dest.type;
  if (_23 == 6)
    goto <bb 9>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _24 = ip_data.current_iphdr_dest.type;
  _25 = 6;
  if (_24 == _25)
    goto <bb 10>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 10> :
  _26 = ip_data.current_iphdr_dest.type;
  if (_26 == 6)
    goto <bb 11>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 11> :
  _27 = ip_data.current_iphdr_dest.u_addr.ip6.addr[0];
  _28 = 767;
  if (_27 != _28)
    goto <bb 15>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 12> :
  _29 = ip_data.current_iphdr_dest.u_addr.ip6.addr[1];
  _30 = 0;
  if (_29 != _30)
    goto <bb 15>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 13> :
  _31 = ip_data.current_iphdr_dest.u_addr.ip6.addr[2];
  _32 = 0;
  if (_31 != _32)
    goto <bb 15>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 14> :
  _33 = ip_data.current_iphdr_dest.u_addr.ip6.addr[3];
  _34 = 4211081216;
  if (_33 != _34)
    goto <bb 15>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 15> :
  iftmp.56 = 1;
  goto <bb 17>; [INV]

  <bb 16> :
  iftmp.56 = 0;

  <bb 17> :
  iftmp.55 = (_Bool) iftmp.56;
  goto <bb 19>; [INV]

  <bb 18> :
  _35 = ip_data.current_iphdr_dest.u_addr.ip4.addr;
  _36 = 767;
  iftmp.55 = _35 != _36;

  <bb 19> :
  iftmp.54 = iftmp.55;
  goto <bb 21>; [INV]

  <bb 20> :
  iftmp.54 = 1;

  <bb 21> :
  if (iftmp.54 != 0)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  packet.recv_unicast = 1;

  <bb 23> :
  # DEBUG BEGIN_STMT
  _37 = ip_data.current_iphdr_dest.type;
  if (_37 != 6)
    goto <bb 24>; [INV]
  else
    goto <bb 39>; [INV]

  <bb 24> :
  # DEBUG BEGIN_STMT
  _38 = ip_data.current_iphdr_dest.type;
  _39 = 0;
  if (_38 == _39)
    goto <bb 25>; [INV]
  else
    goto <bb 36>; [INV]

  <bb 25> :
  _40 = ip_data.current_iphdr_dest.type;
  if (_40 == 6)
    goto <bb 26>; [INV]
  else
    goto <bb 34>; [INV]

  <bb 26> :
  _41 = ip_data.current_iphdr_dest.u_addr.ip6.addr[0];
  _42 = 4211081440;
  if (_41 != _42)
    goto <bb 31>; [INV]
  else
    goto <bb 27>; [INV]

  <bb 27> :
  _43 = ip_data.current_iphdr_dest.u_addr.ip6.addr[1];
  _44 = 0;
  if (_43 != _44)
    goto <bb 31>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 28> :
  _45 = ip_data.current_iphdr_dest.u_addr.ip6.addr[2];
  _46 = 0;
  if (_45 != _46)
    goto <bb 31>; [INV]
  else
    goto <bb 29>; [INV]

  <bb 29> :
  _47 = ip_data.current_iphdr_dest.u_addr.ip6.addr[3];
  _48 = 0;
  if (_47 != _48)
    goto <bb 31>; [INV]
  else
    goto <bb 30>; [INV]

  <bb 30> :
  _49 = ip_data.current_iphdr_dest.u_addr.ip6.zone;
  _50 = 0;
  if (_49 != _50)
    goto <bb 31>; [INV]
  else
    goto <bb 32>; [INV]

  <bb 31> :
  iftmp.59 = 1;
  goto <bb 33>; [INV]

  <bb 32> :
  iftmp.59 = 0;

  <bb 33> :
  iftmp.58 = (_Bool) iftmp.59;
  goto <bb 35>; [INV]

  <bb 34> :
  _51 = ip_data.current_iphdr_dest.u_addr.ip4.addr;
  _52 = 4211081440;
  iftmp.58 = _51 != _52;

  <bb 35> :
  iftmp.57 = iftmp.58;
  goto <bb 37>; [INV]

  <bb 36> :
  iftmp.57 = 1;

  <bb 37> :
  if (iftmp.57 != 0)
    goto <bb 38>; [INV]
  else
    goto <bb 39>; [INV]

  <bb 38> :
  # DEBUG BEGIN_STMT
  packet.recv_unicast = 1;

  <bb 39> :
  # DEBUG BEGIN_STMT
  _53 = hdr.flags1;
  _54 = (signed char) _53;
  if (_54 < 0)
    goto <bb 40>; [INV]
  else
    goto <bb 41>; [INV]

  <bb 40> :
  # DEBUG BEGIN_STMT
  mdns_handle_response (&packet);
  goto <bb 42>; [INV]

  <bb 41> :
  # DEBUG BEGIN_STMT
  mdns_handle_question (&packet);

  <bb 42> :
dealloc:
  # DEBUG BEGIN_STMT
  pbuf_free (p);
  hdr = {CLOBBER};
  packet = {CLOBBER};
  return;

}


mdns_handle_response (struct mdns_packet * pkt)
{
  struct mdns_service * service;
  u8_t conflict;
  u8_t i;
  struct mdns_domain domain;
  err_t res;
  struct mdns_answer ans;
  err_t res;
  struct mdns_question q;
  struct mdns_host * mdns;

  <bb 2> :
  # DEBUG BEGIN_STMT
  _1 = pkt->netif;
  mdns_netif_client_id.60_2 = mdns_netif_client_id;
  _3 = (int) mdns_netif_client_id.60_2;
  mdns = _1->client_data[_3];
  # DEBUG BEGIN_STMT
  goto <bb 6>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_read_question (pkt, &q);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  q = {CLOBBER};
  goto <bb 28>; [INV]

  <bb 5> :
  q = {CLOBBER};

  <bb 6> :
  # DEBUG BEGIN_STMT
  _4 = pkt->questions_left;
  if (_4 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 27>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_read_answer (pkt, &ans);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  ans = {CLOBBER};
  goto <bb 28>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_domain_debug_print (&ans.info.domain);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = mdns->probing_state;
  if (_5 == 1)
    goto <bb 10>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 10> :
  _6 = mdns->probes_sent;
  if (_6 != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  conflict = 0;
  # DEBUG BEGIN_STMT
  res = mdns_build_host_domain (&domain, mdns);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 12>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 12> :
  _7 = mdns_domain_eq (&ans.info.domain, &domain);
  if (_7 != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  conflict = 1;

  <bb 14> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 21>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  _8 = (int) i;
  service = mdns->services[_8];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 16>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 20>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  res = mdns_build_service_domain (&domain, service, 1);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 18>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 18> :
  _9 = mdns_domain_eq (&ans.info.domain, &domain);
  if (_9 != 0)
    goto <bb 19>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  conflict = 1;

  <bb 20> :
  # DEBUG BEGIN_STMT
  i.61_10 = i;
  i = i.61_10 + 1;

  <bb 21> :
  # DEBUG BEGIN_STMT
  if (i == 0)
    goto <bb 15>; [INV]
  else
    goto <bb 22>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  if (conflict != 0)
    goto <bb 23>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 23> :
  # DEBUG BEGIN_STMT
  _11 = pkt->netif;
  sys_untimeout (mdns_probe, _11);
  # DEBUG BEGIN_STMT
  mdns_name_result_cb.62_12 = mdns_name_result_cb;
  if (mdns_name_result_cb.62_12 != 0B)
    goto <bb 24>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 24> :
  # DEBUG BEGIN_STMT
  mdns_name_result_cb.63_13 = mdns_name_result_cb;
  _14 = pkt->netif;
  mdns_name_result_cb.63_13 (_14, 0);

  <bb 25> :
  domain = {CLOBBER};

  <bb 26> :
  ans = {CLOBBER};

  <bb 27> :
  # DEBUG BEGIN_STMT
  _15 = pkt->answers_left;
  if (_15 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 28> :
  return;

}


mdns_handle_question (struct mdns_packet * pkt)
{
  struct mdns_domain my_ans;
  struct mdns_domain known_ans;
  u16_t read_pos;
  u16_t len;
  u16_t field16;
  u16_t len;
  struct mdns_domain my_ans;
  struct mdns_domain known_ans;
  u16_t len;
  struct mdns_domain my_ans;
  struct mdns_domain known_ans;
  int match;
  u8_t rev_v6;
  struct mdns_answer ans;
  struct mdns_question q;
  struct mdns_host * mdns;
  err_t res;
  int i;
  int replies;
  struct mdns_outpacket reply;
  struct mdns_service * service;
  int D.8443;
  int D.8440;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  replies = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = pkt->netif;
  mdns_netif_client_id.69_2 = mdns_netif_client_id;
  _3 = (int) mdns_netif_client_id.69_2;
  mdns = _1->client_data[_3];
  # DEBUG BEGIN_STMT
  _4 = mdns->probing_state;
  if (_4 != 2)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 85>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  mdns_init_outpacket (&reply, pkt);
  # DEBUG BEGIN_STMT
  goto <bb 20>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_read_question (pkt, &q);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  // predicted unlikely by early return (on trees) predictor.
  q = {CLOBBER};
  goto <bb 85>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_domain_debug_print (&q.info.domain);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = q.unicast;
  if (_5 != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  reply.unicast_reply = 1;

  <bb 9> :
  # DEBUG BEGIN_STMT
  _6 = pkt->netif;
  D.8440 = check_host (_6, &q.info, &reply.host_reverse_v6_replies);
  _7 = reply.host_replies;
  _8 = (signed char) _7;
  _9 = (signed char) D.8440;
  _10 = _8 | _9;
  _11 = (unsigned char) _10;
  reply.host_replies = _11;
  # DEBUG BEGIN_STMT
  _12 = reply.host_replies;
  _13 = (int) _12;
  replies = replies | _13;
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 14>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  service = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 13>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  D.8443 = check_service (service, &q.info);
  _14 = reply.serv_replies[i];
  _15 = (signed char) _14;
  _16 = (signed char) D.8443;
  _17 = _15 | _16;
  _18 = (unsigned char) _17;
  reply.serv_replies[i] = _18;
  # DEBUG BEGIN_STMT
  _19 = reply.serv_replies[i];
  _20 = (int) _19;
  replies = replies | _20;

  <bb 13> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 14> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 10>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  if (replies != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 16> :
  _21 = reply.legacy_query;
  if (_21 != 0)
    goto <bb 17>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  _22 = q.info.type;
  _23 = q.info.klass;
  res = mdns_add_question (&reply, &q.info.domain, _22, _23, 0);
  # DEBUG BEGIN_STMT
  reply.questions = 1;
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 18>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  q = {CLOBBER};
  goto <bb 82>; [INV]

  <bb 19> :
  q = {CLOBBER};

  <bb 20> :
  # DEBUG BEGIN_STMT
  _24 = pkt->questions_left;
  if (_24 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 80>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_read_answer (pkt, &ans);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  ans = {CLOBBER};
  rev_v6 = {CLOBBER};
  goto <bb 82>; [INV]

  <bb 23> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_domain_debug_print (&ans.info.domain);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _25 = ans.info.type;
  if (_25 == 255)
    goto <bb 25>; [INV]
  else
    goto <bb 24>; [INV]

  <bb 24> :
  _26 = ans.info.klass;
  if (_26 == 255)
    goto <bb 25>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 25> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  ans = {CLOBBER};
  rev_v6 = {CLOBBER};
  goto <bb 80>; [INV]

  <bb 26> :
  # DEBUG BEGIN_STMT
  rev_v6 = 0;
  # DEBUG BEGIN_STMT
  _27 = reply.host_replies;
  _28 = (int) _27;
  _29 = pkt->netif;
  _30 = check_host (_29, &ans.info, &rev_v6);
  match = _28 & _30;
  # DEBUG BEGIN_STMT
  if (match != 0)
    goto <bb 27>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 27> :
  _31 = ans.ttl;
  _32 = mdns->dns_ttl;
  _33 = _32 / 2;
  if (_31 > _33)
    goto <bb 28>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 28> :
  # DEBUG BEGIN_STMT
  _34 = ans.info.type;
  if (_34 == 12)
    goto <bb 29>; [INV]
  else
    goto <bb 38>; [INV]

  <bb 29> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _35 = pkt->pbuf;
  _36 = ans.rd_offset;
  len = mdns_readname (_35, _36, &known_ans);
  # DEBUG BEGIN_STMT
  res = mdns_build_host_domain (&my_ans, mdns);
  # DEBUG BEGIN_STMT
  if (len != 65535)
    goto <bb 30>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 30> :
  if (res == 0)
    goto <bb 31>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 31> :
  _37 = mdns_domain_eq (&known_ans, &my_ans);
  if (_37 != 0)
    goto <bb 32>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 32> :
  # DEBUG BEGIN_STMT
  _38 = match & 2;
  if (_38 != 0)
    goto <bb 33>; [INV]
  else
    goto <bb 34>; [INV]

  <bb 33> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _39 = reply.host_replies;
  _40 = _39 & 253;
  reply.host_replies = _40;

  <bb 34> :
  # DEBUG BEGIN_STMT
  _41 = match & 8;
  if (_41 != 0)
    goto <bb 35>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 35> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _42 = reply.host_reverse_v6_replies;
  _43 = (signed char) _42;
  rev_v6.70_44 = rev_v6;
  rev_v6.71_45 = (signed char) rev_v6.70_44;
  _46 = ~rev_v6.71_45;
  _47 = _43 & _46;
  _48 = (unsigned char) _47;
  reply.host_reverse_v6_replies = _48;
  # DEBUG BEGIN_STMT
  _49 = reply.host_reverse_v6_replies;
  if (_49 == 0)
    goto <bb 36>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 36> :
  # DEBUG BEGIN_STMT
  _50 = reply.host_replies;
  _51 = _50 & 247;
  reply.host_replies = _51;

  <bb 37> :
  known_ans = {CLOBBER};
  my_ans = {CLOBBER};
  goto <bb 46>; [INV]

  <bb 38> :
  # DEBUG BEGIN_STMT
  _52 = match & 1;
  if (_52 != 0)
    goto <bb 39>; [INV]
  else
    goto <bb 42>; [INV]

  <bb 39> :
  # DEBUG BEGIN_STMT
  _53 = ans.rd_length;
  if (_53 == 4)
    goto <bb 40>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 40> :
  _54 = pkt->pbuf;
  _55 = ans.rd_offset;
  _56 = pkt->netif;
  _57 = &_56->ip_addr.u_addr.ip4;
  _58 = ans.rd_length;
  _59 = pbuf_memcmp (_54, _55, _57, _58);
  if (_59 == 0)
    goto <bb 41>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 41> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _60 = reply.host_replies;
  _61 = _60 & 254;
  reply.host_replies = _61;
  goto <bb 46>; [INV]

  <bb 42> :
  # DEBUG BEGIN_STMT
  _62 = match & 4;
  if (_62 != 0)
    goto <bb 43>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 43> :
  # DEBUG BEGIN_STMT
  _63 = ans.rd_length;
  if (_63 == 16)
    goto <bb 44>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 44> :
  _64 = pkt->pbuf;
  _65 = ans.rd_offset;
  _66 = pkt->netif;
  _67 = &_66->ip6_addr[0].u_addr.ip6;
  _68 = ans.rd_length;
  _69 = pbuf_memcmp (_64, _65, _67, _68);
  if (_69 == 0)
    goto <bb 45>; [INV]
  else
    goto <bb 46>; [INV]

  <bb 45> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _70 = reply.host_replies;
  _71 = _70 & 251;
  reply.host_replies = _71;

  <bb 46> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 78>; [INV]

  <bb 47> :
  # DEBUG BEGIN_STMT
  service = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 48>; [INV]
  else
    goto <bb 49>; [INV]

  <bb 48> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 77>; [INV]

  <bb 49> :
  # DEBUG BEGIN_STMT
  _72 = reply.serv_replies[i];
  _73 = (int) _72;
  _74 = check_service (service, &ans.info);
  match = _73 & _74;
  # DEBUG BEGIN_STMT
  if (match != 0)
    goto <bb 50>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 50> :
  _75 = ans.ttl;
  _76 = service->dns_ttl;
  _77 = _76 / 2;
  if (_75 > _77)
    goto <bb 51>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 51> :
  # DEBUG BEGIN_STMT
  _78 = ans.info.type;
  if (_78 == 12)
    goto <bb 52>; [INV]
  else
    goto <bb 62>; [INV]

  <bb 52> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _79 = pkt->pbuf;
  _80 = ans.rd_offset;
  len = mdns_readname (_79, _80, &known_ans);
  # DEBUG BEGIN_STMT
  if (len != 65535)
    goto <bb 53>; [INV]
  else
    goto <bb 61>; [INV]

  <bb 53> :
  # DEBUG BEGIN_STMT
  _81 = match & 16;
  if (_81 != 0)
    goto <bb 54>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 54> :
  # DEBUG BEGIN_STMT
  res = mdns_build_service_domain (&my_ans, service, 0);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 55>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 55> :
  _82 = mdns_domain_eq (&known_ans, &my_ans);
  if (_82 != 0)
    goto <bb 56>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 56> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _83 = reply.serv_replies[i];
  _84 = _83 & 239;
  reply.serv_replies[i] = _84;

  <bb 57> :
  # DEBUG BEGIN_STMT
  _85 = match & 32;
  if (_85 != 0)
    goto <bb 58>; [INV]
  else
    goto <bb 61>; [INV]

  <bb 58> :
  # DEBUG BEGIN_STMT
  res = mdns_build_service_domain (&my_ans, service, 1);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 59>; [INV]
  else
    goto <bb 61>; [INV]

  <bb 59> :
  _86 = mdns_domain_eq (&known_ans, &my_ans);
  if (_86 != 0)
    goto <bb 60>; [INV]
  else
    goto <bb 61>; [INV]

  <bb 60> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _87 = reply.serv_replies[i];
  _88 = _87 & 223;
  reply.serv_replies[i] = _88;

  <bb 61> :
  known_ans = {CLOBBER};
  my_ans = {CLOBBER};
  goto <bb 77>; [INV]

  <bb 62> :
  # DEBUG BEGIN_STMT
  _89 = match & 64;
  if (_89 != 0)
    goto <bb 63>; [INV]
  else
    goto <bb 73>; [INV]

  <bb 63> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  read_pos = ans.rd_offset;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _90 = pkt->pbuf;
  len = pbuf_copy_partial (_90, &field16, 2, read_pos);
  # DEBUG BEGIN_STMT
  if (len != 2)
    goto <bb 72>; [INV]
  else
    goto <bb 64>; [INV]

  <bb 64> :
  field16.72_91 = field16;
  _92 = lwip_htons (field16.72_91);
  if (_92 != 0)
    goto <bb 72>; [INV]
  else
    goto <bb 65>; [INV]

  <bb 65> :
  # DEBUG BEGIN_STMT
  read_pos = read_pos + len;
  # DEBUG BEGIN_STMT
  _93 = pkt->pbuf;
  len = pbuf_copy_partial (_93, &field16, 2, read_pos);
  # DEBUG BEGIN_STMT
  if (len != 2)
    goto <bb 72>; [INV]
  else
    goto <bb 66>; [INV]

  <bb 66> :
  field16.73_94 = field16;
  _95 = lwip_htons (field16.73_94);
  if (_95 != 0)
    goto <bb 72>; [INV]
  else
    goto <bb 67>; [INV]

  <bb 67> :
  # DEBUG BEGIN_STMT
  read_pos = read_pos + len;
  # DEBUG BEGIN_STMT
  _96 = pkt->pbuf;
  len = pbuf_copy_partial (_96, &field16, 2, read_pos);
  # DEBUG BEGIN_STMT
  if (len != 2)
    goto <bb 72>; [INV]
  else
    goto <bb 68>; [INV]

  <bb 68> :
  field16.74_97 = field16;
  _98 = lwip_htons (field16.74_97);
  _99 = service->port;
  if (_98 != _99)
    goto <bb 72>; [INV]
  else
    goto <bb 69>; [INV]

  <bb 69> :
  # DEBUG BEGIN_STMT
  read_pos = read_pos + len;
  # DEBUG BEGIN_STMT
  _100 = pkt->pbuf;
  len = mdns_readname (_100, read_pos, &known_ans);
  # DEBUG BEGIN_STMT
  mdns_build_host_domain (&my_ans, mdns);
  # DEBUG BEGIN_STMT
  if (len == 65535)
    goto <bb 72>; [INV]
  else
    goto <bb 70>; [INV]

  <bb 70> :
  _101 = mdns_domain_eq (&known_ans, &my_ans);
  if (_101 == 0)
    goto <bb 72>; [INV]
  else
    goto <bb 71>; [INV]

  <bb 71> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _102 = reply.serv_replies[i];
  _103 = _102 & 191;
  reply.serv_replies[i] = _103;

  <bb 72> :
  # DEBUG BEGIN_STMT
  field16 = {CLOBBER};
  known_ans = {CLOBBER};
  my_ans = {CLOBBER};
  goto <bb 77>; [INV]

  <bb 73> :
  # DEBUG BEGIN_STMT
  _104 = match & 128;
  if (_104 != 0)
    goto <bb 74>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 74> :
  # DEBUG BEGIN_STMT
  mdns_prepare_txtdata (service);
  # DEBUG BEGIN_STMT
  _105 = service->txtdata.length;
  _106 = ans.rd_length;
  if (_105 == _106)
    goto <bb 75>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 75> :
  _107 = pkt->pbuf;
  _108 = ans.rd_offset;
  _109 = &service->txtdata.name;
  _110 = ans.rd_length;
  _111 = pbuf_memcmp (_107, _108, _109, _110);
  if (_111 == 0)
    goto <bb 76>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 76> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _112 = reply.serv_replies[i];
  _113 = _112 & 127;
  reply.serv_replies[i] = _113;

  <bb 77> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 78> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 47>; [INV]
  else
    goto <bb 79>; [INV]

  <bb 79> :
  ans = {CLOBBER};
  rev_v6 = {CLOBBER};

  <bb 80> :
  # DEBUG BEGIN_STMT
  _114 = pkt->answers_left;
  if (_114 != 0)
    goto <bb 21>; [INV]
  else
    goto <bb 81>; [INV]

  <bb 81> :
  # DEBUG BEGIN_STMT
  mdns_send_outpacket (&reply, 132);

  <bb 82> :
cleanup:
  # DEBUG BEGIN_STMT
  _115 = reply.pbuf;
  if (_115 != 0B)
    goto <bb 83>; [INV]
  else
    goto <bb 84>; [INV]

  <bb 83> :
  # DEBUG BEGIN_STMT
  _116 = reply.pbuf;
  pbuf_free (_116);
  # DEBUG BEGIN_STMT
  reply.pbuf = 0B;

  <bb 84> :
  reply = {CLOBBER};
  goto <bb 86>; [INV]

  <bb 85> :
  reply = {CLOBBER};

  <bb 86> :
  return;

}


mdns_announce (struct netif * netif, const struct ip_addr_t * destination)
{
  struct mdns_service * serv;
  struct mdns_host * mdns;
  int i;
  struct mdns_outpacket announce;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.47_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.47_1;
  mdns = netif->client_data[_2];
  # DEBUG BEGIN_STMT
  memset (&announce, 0, 72);
  # DEBUG BEGIN_STMT
  announce.netif = netif;
  # DEBUG BEGIN_STMT
  announce.cache_flush = 1;
  # DEBUG BEGIN_STMT
  _3 = &netif->ip_addr.u_addr.ip4;
  _4 = MEM[(const struct ip4_addr_t *)_3].addr;
  if (_4 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  announce.host_replies = 3;

  <bb 4> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 8>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _5 = netif->ip6_addr_state[i];
  _6 = (int) _5;
  _7 = _6 & 16;
  if (_7 != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _8 = announce.host_replies;
  _9 = _8 | 12;
  announce.host_replies = _9;
  # DEBUG BEGIN_STMT
  _10 = announce.host_reverse_v6_replies;
  _11 = (signed char) _10;
  _12 = 1 << i;
  _13 = (signed char) _12;
  _14 = _11 | _13;
  _15 = (unsigned char) _14;
  announce.host_reverse_v6_replies = _15;

  <bb 7> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 8> :
  # DEBUG BEGIN_STMT
  if (i <= 2)
    goto <bb 5>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 13>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  serv = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (serv != 0B)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  announce.serv_replies[i] = 240;

  <bb 12> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 13> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 10>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  announce.dest_port = 5353;
  # DEBUG BEGIN_STMT
  memcpy (&announce.dest_addr, destination, 24);
  # DEBUG BEGIN_STMT
  mdns_send_outpacket (&announce, 132);
  announce = {CLOBBER};
  return;

}


mdns_send_outpacket (struct mdns_outpacket * outpkt, u8_t flags)
{
  struct dns_hdr hdr;
  const struct ip_addr_t * mcast_destaddr;
  int addrindex;
  int addrindex;
  u8_t rev_addrs;
  int addrindex;
  u16_t answers;
  struct mdns_host * mdns;
  int i;
  err_t res;
  struct mdns_service * service;
  err_t D.8147;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = -16;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = outpkt->netif;
  mdns_netif_client_id.16_2 = mdns_netif_client_id;
  _3 = (int) mdns_netif_client_id.16_2;
  mdns = _1->client_data[_3];
  # DEBUG BEGIN_STMT
  answers = 0;
  # DEBUG BEGIN_STMT
  _4 = outpkt->host_replies;
  _5 = (int) _4;
  _6 = _5 & 1;
  if (_6 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  _7 = outpkt->cache_flush;
  _8 = (short unsigned int) _7;
  _9 = outpkt->netif;
  res = mdns_add_a_answer (outpkt, _8, _9);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  answers.17_10 = answers;
  answers = answers.17_10 + 1;

  <bb 6> :
  # DEBUG BEGIN_STMT
  _11 = outpkt->host_replies;
  _12 = (int) _11;
  _13 = _12 & 2;
  if (_13 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _14 = outpkt->cache_flush;
  _15 = (short unsigned int) _14;
  _16 = outpkt->netif;
  res = mdns_add_hostv4_ptr_answer (outpkt, _15, _16);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  answers.18_17 = answers;
  answers = answers.18_17 + 1;

  <bb 10> :
  # DEBUG BEGIN_STMT
  _18 = outpkt->host_replies;
  _19 = (int) _18;
  _20 = _19 & 4;
  if (_20 != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  addrindex = 0;
  goto <bb 17>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  _21 = outpkt->netif;
  _22 = _21->ip6_addr_state[addrindex];
  _23 = (int) _22;
  _24 = _23 & 16;
  if (_24 != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  _25 = outpkt->cache_flush;
  _26 = (short unsigned int) _25;
  _27 = outpkt->netif;
  res = mdns_add_aaaa_answer (outpkt, _26, _27, addrindex);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  answers.19_28 = answers;
  answers = answers.19_28 + 1;

  <bb 16> :
  # DEBUG BEGIN_STMT
  addrindex = addrindex + 1;

  <bb 17> :
  # DEBUG BEGIN_STMT
  if (addrindex <= 2)
    goto <bb 12>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  _29 = outpkt->host_replies;
  _30 = (int) _29;
  _31 = _30 & 8;
  if (_31 != 0)
    goto <bb 19>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  rev_addrs = outpkt->host_reverse_v6_replies;
  # DEBUG BEGIN_STMT
  addrindex = 0;
  # DEBUG BEGIN_STMT
  goto <bb 25>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  _32 = (int) rev_addrs;
  _33 = _32 & 1;
  if (_33 != 0)
    goto <bb 21>; [INV]
  else
    goto <bb 24>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  _34 = outpkt->cache_flush;
  _35 = (short unsigned int) _34;
  _36 = outpkt->netif;
  res = mdns_add_hostv6_ptr_answer (outpkt, _35, _36, addrindex);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 23> :
  # DEBUG BEGIN_STMT
  answers.20_37 = answers;
  answers = answers.20_37 + 1;

  <bb 24> :
  # DEBUG BEGIN_STMT
  addrindex = addrindex + 1;
  # DEBUG BEGIN_STMT
  rev_addrs = rev_addrs >> 1;

  <bb 25> :
  # DEBUG BEGIN_STMT
  if (rev_addrs != 0)
    goto <bb 20>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 26> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 46>; [INV]

  <bb 27> :
  # DEBUG BEGIN_STMT
  service = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 28>; [INV]
  else
    goto <bb 29>; [INV]

  <bb 28> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 45>; [INV]

  <bb 29> :
  # DEBUG BEGIN_STMT
  _38 = outpkt->serv_replies[i];
  _39 = (int) _38;
  _40 = _39 & 16;
  if (_40 != 0)
    goto <bb 30>; [INV]
  else
    goto <bb 33>; [INV]

  <bb 30> :
  # DEBUG BEGIN_STMT
  res = mdns_add_servicetype_ptr_answer (outpkt, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 31>; [INV]
  else
    goto <bb 32>; [INV]

  <bb 31> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 32> :
  # DEBUG BEGIN_STMT
  answers.21_41 = answers;
  answers = answers.21_41 + 1;

  <bb 33> :
  # DEBUG BEGIN_STMT
  _42 = outpkt->serv_replies[i];
  _43 = (int) _42;
  _44 = _43 & 32;
  if (_44 != 0)
    goto <bb 34>; [INV]
  else
    goto <bb 37>; [INV]

  <bb 34> :
  # DEBUG BEGIN_STMT
  res = mdns_add_servicename_ptr_answer (outpkt, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 35>; [INV]
  else
    goto <bb 36>; [INV]

  <bb 35> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 36> :
  # DEBUG BEGIN_STMT
  answers.22_45 = answers;
  answers = answers.22_45 + 1;

  <bb 37> :
  # DEBUG BEGIN_STMT
  _46 = outpkt->serv_replies[i];
  _47 = (int) _46;
  _48 = _47 & 64;
  if (_48 != 0)
    goto <bb 38>; [INV]
  else
    goto <bb 41>; [INV]

  <bb 38> :
  # DEBUG BEGIN_STMT
  _49 = outpkt->cache_flush;
  _50 = (short unsigned int) _49;
  res = mdns_add_srv_answer (outpkt, _50, mdns, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 39>; [INV]
  else
    goto <bb 40>; [INV]

  <bb 39> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 40> :
  # DEBUG BEGIN_STMT
  answers.23_51 = answers;
  answers = answers.23_51 + 1;

  <bb 41> :
  # DEBUG BEGIN_STMT
  _52 = outpkt->serv_replies[i];
  _53 = (signed char) _52;
  if (_53 < 0)
    goto <bb 42>; [INV]
  else
    goto <bb 45>; [INV]

  <bb 42> :
  # DEBUG BEGIN_STMT
  _54 = outpkt->cache_flush;
  _55 = (short unsigned int) _54;
  res = mdns_add_txt_answer (outpkt, _55, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 43>; [INV]
  else
    goto <bb 44>; [INV]

  <bb 43> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 44> :
  # DEBUG BEGIN_STMT
  answers.24_56 = answers;
  answers = answers.24_56 + 1;

  <bb 45> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 46> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 27>; [INV]
  else
    goto <bb 47>; [INV]

  <bb 47> :
  # DEBUG BEGIN_STMT
  flags.25_57 = (signed char) flags;
  if (flags.25_57 < 0)
    goto <bb 48>; [INV]
  else
    goto <bb 49>; [INV]

  <bb 48> :
  # DEBUG BEGIN_STMT
  _58 = outpkt->answers;
  _59 = answers + _58;
  outpkt->answers = _59;
  goto <bb 50>; [INV]

  <bb 49> :
  # DEBUG BEGIN_STMT
  _60 = outpkt->authoritative;
  _61 = answers + _60;
  outpkt->authoritative = _61;

  <bb 50> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 78>; [INV]

  <bb 51> :
  # DEBUG BEGIN_STMT
  service = mdns->services[i];
  # DEBUG BEGIN_STMT
  if (service == 0B)
    goto <bb 52>; [INV]
  else
    goto <bb 53>; [INV]

  <bb 52> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by continue predictor.
  goto <bb 77>; [INV]

  <bb 53> :
  # DEBUG BEGIN_STMT
  _62 = outpkt->serv_replies[i];
  _63 = (int) _62;
  _64 = _63 & 32;
  if (_64 != 0)
    goto <bb 54>; [INV]
  else
    goto <bb 62>; [INV]

  <bb 54> :
  # DEBUG BEGIN_STMT
  _65 = outpkt->serv_replies[i];
  _66 = (int) _65;
  _67 = _66 & 64;
  if (_67 == 0)
    goto <bb 55>; [INV]
  else
    goto <bb 58>; [INV]

  <bb 55> :
  # DEBUG BEGIN_STMT
  _68 = outpkt->cache_flush;
  _69 = (short unsigned int) _68;
  res = mdns_add_srv_answer (outpkt, _69, mdns, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 56>; [INV]
  else
    goto <bb 57>; [INV]

  <bb 56> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 57> :
  # DEBUG BEGIN_STMT
  _70 = outpkt->additional;
  _71 = _70;
  _72 = _71 + 1;
  outpkt->additional = _72;

  <bb 58> :
  # DEBUG BEGIN_STMT
  _73 = outpkt->serv_replies[i];
  _74 = (signed char) _73;
  if (_74 >= 0)
    goto <bb 59>; [INV]
  else
    goto <bb 62>; [INV]

  <bb 59> :
  # DEBUG BEGIN_STMT
  _75 = outpkt->cache_flush;
  _76 = (short unsigned int) _75;
  res = mdns_add_txt_answer (outpkt, _76, service);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 60>; [INV]
  else
    goto <bb 61>; [INV]

  <bb 60> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 61> :
  # DEBUG BEGIN_STMT
  _77 = outpkt->additional;
  _78 = _77;
  _79 = _78 + 1;
  outpkt->additional = _79;

  <bb 62> :
  # DEBUG BEGIN_STMT
  _80 = outpkt->serv_replies[i];
  _81 = (int) _80;
  _82 = _81 & 96;
  if (_82 != 0)
    goto <bb 64>; [INV]
  else
    goto <bb 63>; [INV]

  <bb 63> :
  _83 = outpkt->host_replies;
  _84 = (int) _83;
  _85 = _84 & 5;
  if (_85 != 0)
    goto <bb 64>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 64> :
  # DEBUG BEGIN_STMT
  _86 = outpkt->host_replies;
  _87 = (int) _86;
  _88 = _87 & 4;
  if (_88 == 0)
    goto <bb 65>; [INV]
  else
    goto <bb 72>; [INV]

  <bb 65> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  addrindex = 0;
  goto <bb 71>; [INV]

  <bb 66> :
  # DEBUG BEGIN_STMT
  _89 = outpkt->netif;
  _90 = _89->ip6_addr_state[addrindex];
  _91 = (int) _90;
  _92 = _91 & 16;
  if (_92 != 0)
    goto <bb 67>; [INV]
  else
    goto <bb 70>; [INV]

  <bb 67> :
  # DEBUG BEGIN_STMT
  _93 = outpkt->cache_flush;
  _94 = (short unsigned int) _93;
  _95 = outpkt->netif;
  res = mdns_add_aaaa_answer (outpkt, _94, _95, addrindex);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 68>; [INV]
  else
    goto <bb 69>; [INV]

  <bb 68> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 69> :
  # DEBUG BEGIN_STMT
  _96 = outpkt->additional;
  _97 = _96;
  _98 = _97 + 1;
  outpkt->additional = _98;

  <bb 70> :
  # DEBUG BEGIN_STMT
  addrindex = addrindex + 1;

  <bb 71> :
  # DEBUG BEGIN_STMT
  if (addrindex <= 2)
    goto <bb 66>; [INV]
  else
    goto <bb 72>; [INV]

  <bb 72> :
  # DEBUG BEGIN_STMT
  _99 = outpkt->host_replies;
  _100 = (int) _99;
  _101 = _100 & 1;
  if (_101 == 0)
    goto <bb 73>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 73> :
  _102 = outpkt->netif;
  _103 = &_102->ip_addr.u_addr.ip4;
  _104 = MEM[(const struct ip4_addr_t *)_103].addr;
  if (_104 != 0)
    goto <bb 74>; [INV]
  else
    goto <bb 77>; [INV]

  <bb 74> :
  # DEBUG BEGIN_STMT
  _105 = outpkt->cache_flush;
  _106 = (short unsigned int) _105;
  _107 = outpkt->netif;
  res = mdns_add_a_answer (outpkt, _106, _107);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 75>; [INV]
  else
    goto <bb 76>; [INV]

  <bb 75> :
  # DEBUG BEGIN_STMT
  // predicted unlikely by goto predictor.
  goto <bb 87>; [INV]

  <bb 76> :
  # DEBUG BEGIN_STMT
  _108 = outpkt->additional;
  _109 = _108;
  _110 = _109 + 1;
  outpkt->additional = _110;

  <bb 77> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 78> :
  # DEBUG BEGIN_STMT
  if (i <= 0)
    goto <bb 51>; [INV]
  else
    goto <bb 79>; [INV]

  <bb 79> :
  # DEBUG BEGIN_STMT
  _111 = outpkt->pbuf;
  if (_111 != 0B)
    goto <bb 80>; [INV]
  else
    goto <bb 87>; [INV]

  <bb 80> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  memset (&hdr, 0, 12);
  # DEBUG BEGIN_STMT
  hdr.flags1 = flags;
  # DEBUG BEGIN_STMT
  _112 = outpkt->questions;
  _113 = lwip_htons (_112);
  hdr.numquestions = _113;
  # DEBUG BEGIN_STMT
  _114 = outpkt->answers;
  _115 = lwip_htons (_114);
  hdr.numanswers = _115;
  # DEBUG BEGIN_STMT
  _116 = outpkt->authoritative;
  _117 = lwip_htons (_116);
  hdr.numauthrr = _117;
  # DEBUG BEGIN_STMT
  _118 = outpkt->additional;
  _119 = lwip_htons (_118);
  hdr.numextrarr = _119;
  # DEBUG BEGIN_STMT
  _120 = outpkt->tx_id;
  _121 = lwip_htons (_120);
  hdr.id = _121;
  # DEBUG BEGIN_STMT
  _122 = outpkt->pbuf;
  pbuf_take (_122, &hdr, 12);
  # DEBUG BEGIN_STMT
  _123 = outpkt->pbuf;
  _124 = outpkt->write_offset;
  pbuf_realloc (_123, _124);
  # DEBUG BEGIN_STMT
  _125 = outpkt->dest_addr.type;
  if (_125 == 6)
    goto <bb 81>; [INV]
  else
    goto <bb 82>; [INV]

  <bb 81> :
  # DEBUG BEGIN_STMT
  mcast_destaddr = &v6group;
  goto <bb 83>; [INV]

  <bb 82> :
  # DEBUG BEGIN_STMT
  mcast_destaddr = &v4group;

  <bb 83> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _126 = outpkt->unicast_reply;
  if (_126 != 0)
    goto <bb 84>; [INV]
  else
    goto <bb 85>; [INV]

  <bb 84> :
  # DEBUG BEGIN_STMT
  mdns_pcb.26_127 = mdns_pcb;
  _128 = outpkt->pbuf;
  _129 = &outpkt->dest_addr;
  _130 = outpkt->dest_port;
  _131 = outpkt->netif;
  res = udp_sendto_if (mdns_pcb.26_127, _128, _129, _130, _131);
  goto <bb 86>; [INV]

  <bb 85> :
  # DEBUG BEGIN_STMT
  mdns_pcb.27_132 = mdns_pcb;
  _133 = outpkt->pbuf;
  _134 = outpkt->netif;
  res = udp_sendto_if (mdns_pcb.27_132, _133, mcast_destaddr, 5353, _134);

  <bb 86> :
  hdr = {CLOBBER};

  <bb 87> :
cleanup:
  # DEBUG BEGIN_STMT
  _135 = outpkt->pbuf;
  if (_135 != 0B)
    goto <bb 88>; [INV]
  else
    goto <bb 89>; [INV]

  <bb 88> :
  # DEBUG BEGIN_STMT
  _136 = outpkt->pbuf;
  pbuf_free (_136);
  # DEBUG BEGIN_STMT
  outpkt->pbuf = 0B;

  <bb 89> :
  # DEBUG BEGIN_STMT
  D.8147 = res;
  return D.8147;

}


mdns_init_outpacket (struct mdns_outpacket * out, struct mdns_packet * in)
{
  <bb 2> :
  # DEBUG BEGIN_STMT
  memset (out, 0, 72);
  # DEBUG BEGIN_STMT
  out->cache_flush = 1;
  # DEBUG BEGIN_STMT
  _1 = in->netif;
  out->netif = _1;
  # DEBUG BEGIN_STMT
  _2 = &out->dest_addr;
  _3 = &in->source_addr;
  memcpy (_2, _3, 24);
  # DEBUG BEGIN_STMT
  _4 = in->source_port;
  out->dest_port = _4;
  # DEBUG BEGIN_STMT
  _5 = in->source_port;
  if (_5 != 5353)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  out->unicast_reply = 1;
  # DEBUG BEGIN_STMT
  out->cache_flush = 0;
  # DEBUG BEGIN_STMT
  _6 = in->questions;
  if (_6 == 1)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  out->legacy_query = 1;
  # DEBUG BEGIN_STMT
  _7 = in->tx_id;
  out->tx_id = _7;

  <bb 5> :
  # DEBUG BEGIN_STMT
  _8 = in->recv_unicast;
  if (_8 != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  out->unicast_reply = 1;

  <bb 7> :
  return;

}


mdns_add_txt_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct mdns_service * service)
{
  struct mdns_domain service_instance;
  err_t D.8230;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&service_instance, service, 1);
  # DEBUG BEGIN_STMT
  mdns_prepare_txtdata (service);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = service->dns_ttl;
  _2 = &service->txtdata.name;
  _3 = service->txtdata.length;
  _4 = (unsigned int) _3;
  D.8230 = mdns_add_answer (reply, &service_instance, 16, 1, cache_flush, _1, _2, _4, 0B);
  service_instance = {CLOBBER};
  return D.8230;

}


mdns_add_srv_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct mdns_host * mdns, struct mdns_service * service)
{
  u16_t srvdata[3];
  struct mdns_domain srvhost;
  struct mdns_domain service_instance;
  err_t D.8227;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&service_instance, service, 1);
  # DEBUG BEGIN_STMT
  mdns_build_host_domain (&srvhost, mdns);
  # DEBUG BEGIN_STMT
  _1 = reply->legacy_query;
  if (_1 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  srvhost.skip_compression = 1;

  <bb 4> :
  # DEBUG BEGIN_STMT
  _2 = lwip_htons (0);
  srvdata[0] = _2;
  # DEBUG BEGIN_STMT
  _3 = lwip_htons (0);
  srvdata[1] = _3;
  # DEBUG BEGIN_STMT
  _4 = service->port;
  _5 = lwip_htons (_4);
  srvdata[2] = _5;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _6 = service->dns_ttl;
  D.8227 = mdns_add_answer (reply, &service_instance, 33, 1, cache_flush, _6, &srvdata, 6, &srvhost);
  service_instance = {CLOBBER};
  srvhost = {CLOBBER};
  srvdata = {CLOBBER};
  return D.8227;

}


mdns_add_servicename_ptr_answer (struct mdns_outpacket * reply, struct mdns_service * service)
{
  struct mdns_domain service_instance;
  struct mdns_domain service_type;
  err_t D.8222;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&service_type, service, 0);
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&service_instance, service, 1);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = service->dns_ttl;
  D.8222 = mdns_add_answer (reply, &service_type, 12, 1, 0, _1, 0B, 0, &service_instance);
  service_type = {CLOBBER};
  service_instance = {CLOBBER};
  return D.8222;

}


mdns_add_servicetype_ptr_answer (struct mdns_outpacket * reply, struct mdns_service * service)
{
  struct mdns_domain service_dnssd;
  struct mdns_domain service_type;
  err_t D.8211;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_build_service_domain (&service_type, service, 0);
  # DEBUG BEGIN_STMT
  mdns_build_dnssd_domain (&service_dnssd);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = service->dns_ttl;
  D.8211 = mdns_add_answer (reply, &service_dnssd, 12, 1, 0, _1, 0B, 0, &service_type);
  service_type = {CLOBBER};
  service_dnssd = {CLOBBER};
  return D.8211;

}


mdns_add_hostv6_ptr_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct netif * netif, int addrindex)
{
  struct mdns_domain revhost;
  struct mdns_domain host;
  err_t D.8190;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.31_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.31_1;
  _3 = netif->client_data[_2];
  mdns_build_host_domain (&host, _3);
  # DEBUG BEGIN_STMT
  _4 = &netif->ip6_addr[addrindex].u_addr.ip6;
  mdns_build_reverse_v6_domain (&revhost, _4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.32_5 = mdns_netif_client_id;
  _6 = (int) mdns_netif_client_id.32_5;
  _7 = netif->client_data[_6];
  _8 = MEM[(struct mdns_host *)_7].dns_ttl;
  D.8190 = mdns_add_answer (reply, &revhost, 12, 1, cache_flush, _8, 0B, 0, &host);
  host = {CLOBBER};
  revhost = {CLOBBER};
  return D.8190;

}


mdns_add_aaaa_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct netif * netif, int addrindex)
{
  struct mdns_domain host;
  err_t D.8235;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.34_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.34_1;
  _3 = netif->client_data[_2];
  mdns_build_host_domain (&host, _3);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.35_4 = mdns_netif_client_id;
  _5 = (int) mdns_netif_client_id.35_4;
  _6 = netif->client_data[_5];
  _7 = MEM[(struct mdns_host *)_6].dns_ttl;
  _8 = &netif->ip6_addr[addrindex].u_addr.ip6;
  D.8235 = mdns_add_answer (reply, &host, 28, 1, cache_flush, _7, _8, 16, 0B);
  host = {CLOBBER};
  return D.8235;

}


mdns_add_hostv4_ptr_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct netif * netif)
{
  struct mdns_domain revhost;
  struct mdns_domain host;
  err_t D.8149;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.28_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.28_1;
  _3 = netif->client_data[_2];
  mdns_build_host_domain (&host, _3);
  # DEBUG BEGIN_STMT
  _4 = &netif->ip_addr.u_addr.ip4;
  mdns_build_reverse_v4_domain (&revhost, _4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.29_5 = mdns_netif_client_id;
  _6 = (int) mdns_netif_client_id.29_5;
  _7 = netif->client_data[_6];
  _8 = MEM[(struct mdns_host *)_7].dns_ttl;
  D.8149 = mdns_add_answer (reply, &revhost, 12, 1, cache_flush, _8, 0B, 0, &host);
  host = {CLOBBER};
  revhost = {CLOBBER};
  return D.8149;

}


mdns_add_a_answer (struct mdns_outpacket * reply, u16_t cache_flush, struct netif * netif)
{
  struct mdns_domain host;
  err_t D.8238;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.36_1 = mdns_netif_client_id;
  _2 = (int) mdns_netif_client_id.36_1;
  _3 = netif->client_data[_2];
  mdns_build_host_domain (&host, _3);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.37_4 = mdns_netif_client_id;
  _5 = (int) mdns_netif_client_id.37_4;
  _6 = netif->client_data[_5];
  _7 = MEM[(struct mdns_host *)_6].dns_ttl;
  _8 = &netif->ip_addr.u_addr.ip4;
  D.8238 = mdns_add_answer (reply, &host, 1, 1, cache_flush, _7, _8, 4, 0B);
  host = {CLOBBER};
  return D.8238;

}


mdns_read_answer (struct mdns_packet * pkt, struct mdns_answer * answer)
{
  err_t res;
  u32_t ttl;
  u16_t field16;
  u16_t copied;
  err_t D.8421;

  <bb 2> :
  # DEBUG BEGIN_STMT
  _1 = pkt->questions_left;
  if (_1 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8421 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _2 = pkt->pbuf;
  _3 = _2->tot_len;
  _4 = pkt->parse_offset;
  if (_3 < _4)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8421 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _5 = pkt->answers_left;
  if (_5 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _6 = pkt->answers_left;
  _7 = _6;
  _8 = _7 + 65535;
  pkt->answers_left = _8;
  # DEBUG BEGIN_STMT
  memset (answer, 0, 276);
  # DEBUG BEGIN_STMT
  _9 = &answer->info;
  res = mdns_read_rr_info (pkt, _9);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  D.8421 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _10 = answer->info.klass;
  _11 = _10 & 32768;
  answer->cache_flush = _11;
  # DEBUG BEGIN_STMT
  _12 = answer->info.klass;
  _13 = _12 & 32767;
  answer->info.klass = _13;
  # DEBUG BEGIN_STMT
  _14 = pkt->pbuf;
  _15 = pkt->parse_offset;
  copied = pbuf_copy_partial (_14, &ttl, 4, _15);
  # DEBUG BEGIN_STMT
  if (copied != 4)
    goto <bb 10>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  D.8421 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  _16 = pkt->parse_offset;
  _17 = copied + _16;
  pkt->parse_offset = _17;
  # DEBUG BEGIN_STMT
  ttl.66_18 = ttl;
  _19 = lwip_htonl (ttl.66_18);
  answer->ttl = _19;
  # DEBUG BEGIN_STMT
  _20 = pkt->pbuf;
  _21 = pkt->parse_offset;
  copied = pbuf_copy_partial (_20, &field16, 2, _21);
  # DEBUG BEGIN_STMT
  if (copied != 2)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  D.8421 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  _22 = pkt->parse_offset;
  _23 = copied + _22;
  pkt->parse_offset = _23;
  # DEBUG BEGIN_STMT
  field16.67_24 = field16;
  _25 = lwip_htons (field16.67_24);
  answer->rd_length = _25;
  # DEBUG BEGIN_STMT
  _26 = pkt->parse_offset;
  answer->rd_offset = _26;
  # DEBUG BEGIN_STMT
  _27 = pkt->parse_offset;
  _28 = answer->rd_length;
  _29 = _27 + _28;
  pkt->parse_offset = _29;
  # DEBUG BEGIN_STMT
  D.8421 = 0;
  // predicted unlikely by early return (on trees) predictor.

  <bb 14> :
  field16 = {CLOBBER};
  ttl = {CLOBBER};
  goto <bb 16>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  D.8421 = -6;

  <bb 16> :
  return D.8421;

}


mdns_read_question (struct mdns_packet * pkt, struct mdns_question * question)
{
  err_t res;
  err_t D.8404;

  <bb 2> :
  # DEBUG BEGIN_STMT
  _1 = pkt->pbuf;
  _2 = _1->tot_len;
  _3 = pkt->parse_offset;
  if (_2 < _3)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8404 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _4 = pkt->questions_left;
  if (_4 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = pkt->questions_left;
  _6 = _5;
  _7 = _6 + 65535;
  pkt->questions_left = _7;
  # DEBUG BEGIN_STMT
  memset (question, 0, 266);
  # DEBUG BEGIN_STMT
  _8 = &question->info;
  res = mdns_read_rr_info (pkt, _8);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.8404 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _9 = question->info.klass;
  _10 = _9 & 32768;
  question->unicast = _10;
  # DEBUG BEGIN_STMT
  _11 = question->info.klass;
  _12 = _11 & 32767;
  question->info.klass = _12;
  # DEBUG BEGIN_STMT
  D.8404 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  D.8404 = -6;

  <bb 9> :
  return D.8404;

}


mdns_read_rr_info (struct mdns_packet * pkt, struct mdns_rr_info * info)
{
  u16_t copied;
  u16_t field16;
  err_t D.8412;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = pkt->pbuf;
  _2 = pkt->parse_offset;
  _3 = &info->domain;
  _4 = mdns_readname (_1, _2, _3);
  pkt->parse_offset = _4;
  # DEBUG BEGIN_STMT
  _5 = pkt->parse_offset;
  if (_5 == 65535)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8412 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _6 = pkt->pbuf;
  _7 = pkt->parse_offset;
  copied = pbuf_copy_partial (_6, &field16, 2, _7);
  # DEBUG BEGIN_STMT
  if (copied != 2)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8412 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _8 = pkt->parse_offset;
  _9 = copied + _8;
  pkt->parse_offset = _9;
  # DEBUG BEGIN_STMT
  field16.64_10 = field16;
  _11 = lwip_htons (field16.64_10);
  info->type = _11;
  # DEBUG BEGIN_STMT
  _12 = pkt->pbuf;
  _13 = pkt->parse_offset;
  copied = pbuf_copy_partial (_12, &field16, 2, _13);
  # DEBUG BEGIN_STMT
  if (copied != 2)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8412 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  _14 = pkt->parse_offset;
  _15 = copied + _14;
  pkt->parse_offset = _15;
  # DEBUG BEGIN_STMT
  field16.65_16 = field16;
  _17 = lwip_htons (field16.65_16);
  info->klass = _17;
  # DEBUG BEGIN_STMT
  D.8412 = 0;

  <bb 9> :
  field16 = {CLOBBER};
  return D.8412;

}


mdns_add_answer (struct mdns_outpacket * reply, struct mdns_domain * domain, u16_t type, u16_t klass, u16_t cache_flush, u32_t ttl, const u8_t * buf, size_t buf_length, struct mdns_domain * answer_domain)
{
  err_t res;
  u32_t field32;
  u16_t answer_offset;
  u16_t rdlen_offset;
  u16_t field16;
  u16_t answer_len;
  err_t D.8171;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = reply->pbuf;
  if (_1 == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  _2 = pbuf_alloc (74, 500, 640);
  reply->pbuf = _2;
  # DEBUG BEGIN_STMT
  _3 = reply->pbuf;
  if (_3 == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8171 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 22>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  reply->write_offset = 12;

  <bb 6> :
  # DEBUG BEGIN_STMT
  _4 = domain->length;
  answer_len = _4 + 10;
  # DEBUG BEGIN_STMT
  if (buf != 0B)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _5 = (short unsigned int) buf_length;
  answer_len = answer_len + _5;

  <bb 8> :
  # DEBUG BEGIN_STMT
  if (answer_domain != 0B)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _6 = answer_domain->length;
  answer_len = answer_len + _6;

  <bb 10> :
  # DEBUG BEGIN_STMT
  _7 = reply->write_offset;
  _8 = (int) _7;
  _9 = (int) answer_len;
  _10 = _8 + _9;
  _11 = reply->pbuf;
  _12 = _11->tot_len;
  _13 = (int) _12;
  if (_10 > _13)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8171 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 22>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  mdns_add_question (reply, domain, type, klass, cache_flush);
  # DEBUG BEGIN_STMT
  _14 = lwip_htonl (ttl);
  field32 = _14;
  # DEBUG BEGIN_STMT
  _15 = reply->pbuf;
  _16 = reply->write_offset;
  res = pbuf_take_at (_15, &field32, 4, _16);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  D.8171 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 22>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  _17 = reply->write_offset;
  _18 = _17 + 4;
  reply->write_offset = _18;
  # DEBUG BEGIN_STMT
  rdlen_offset = reply->write_offset;
  # DEBUG BEGIN_STMT
  _19 = reply->write_offset;
  _20 = _19 + 2;
  reply->write_offset = _20;
  # DEBUG BEGIN_STMT
  answer_offset = reply->write_offset;
  # DEBUG BEGIN_STMT
  if (buf != 0B)
    goto <bb 15>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  _21 = reply->pbuf;
  _22 = (short unsigned int) buf_length;
  _23 = reply->write_offset;
  res = pbuf_take_at (_21, buf, _22, _23);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  D.8171 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 22>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  _24 = reply->write_offset;
  _25 = (short unsigned int) buf_length;
  _26 = _24 + _25;
  reply->write_offset = _26;

  <bb 18> :
  # DEBUG BEGIN_STMT
  if (answer_domain != 0B)
    goto <bb 19>; [INV]
  else
    goto <bb 21>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  res = mdns_write_domain (reply, answer_domain);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 20>; [INV]
  else
    goto <bb 21>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  D.8171 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 22>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  _27 = reply->write_offset;
  _28 = _27 - answer_offset;
  _29 = lwip_htons (_28);
  field16 = _29;
  # DEBUG BEGIN_STMT
  _30 = reply->pbuf;
  res = pbuf_take_at (_30, &field16, 2, rdlen_offset);
  # DEBUG BEGIN_STMT
  D.8171 = res;

  <bb 22> :
  field16 = {CLOBBER};
  field32 = {CLOBBER};
  return D.8171;

}


mdns_add_question (struct mdns_outpacket * outpkt, struct mdns_domain * domain, u16_t type, u16_t klass, u16_t unicast)
{
  err_t res;
  u16_t field16;
  u16_t question_len;
  err_t D.8037;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = outpkt->pbuf;
  if (_1 == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  _2 = pbuf_alloc (74, 500, 640);
  outpkt->pbuf = _2;
  # DEBUG BEGIN_STMT
  _3 = outpkt->pbuf;
  if (_3 == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8037 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  outpkt->write_offset = 12;

  <bb 6> :
  # DEBUG BEGIN_STMT
  _4 = domain->length;
  question_len = _4 + 4;
  # DEBUG BEGIN_STMT
  _5 = outpkt->write_offset;
  _6 = (int) _5;
  _7 = (int) question_len;
  _8 = _6 + _7;
  _9 = outpkt->pbuf;
  _10 = _9->tot_len;
  _11 = (int) _10;
  if (_8 > _11)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8037 = -1;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  res = mdns_write_domain (outpkt, domain);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.8037 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  _12 = lwip_htons (type);
  field16 = _12;
  # DEBUG BEGIN_STMT
  _13 = outpkt->pbuf;
  _14 = outpkt->write_offset;
  res = pbuf_take_at (_13, &field16, 2, _14);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8037 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  _15 = outpkt->write_offset;
  _16 = _15 + 2;
  outpkt->write_offset = _16;
  # DEBUG BEGIN_STMT
  if (unicast != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  klass = klass | 32768;

  <bb 14> :
  # DEBUG BEGIN_STMT
  _17 = lwip_htons (klass);
  field16 = _17;
  # DEBUG BEGIN_STMT
  _18 = outpkt->pbuf;
  _19 = outpkt->write_offset;
  res = pbuf_take_at (_18, &field16, 2, _19);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 15>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  D.8037 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  _20 = outpkt->write_offset;
  _21 = _20 + 2;
  outpkt->write_offset = _21;
  # DEBUG BEGIN_STMT
  D.8037 = 0;

  <bb 17> :
  field16 = {CLOBBER};
  return D.8037;

}


mdns_write_domain (struct mdns_outpacket * outpkt, struct mdns_domain * domain)
{
  u16_t len;
  u16_t offset;
  u16_t jump;
  u16_t jump_offset;
  u16_t writelen;
  err_t res;
  int i;
  err_t D.8060;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  writelen = domain->length;
  # DEBUG BEGIN_STMT
  jump_offset = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = domain->skip_compression;
  if (_1 == 0)
    goto <bb 3>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 8>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _2 = outpkt->domain_offsets[i];
  offset = _2;
  # DEBUG BEGIN_STMT
  offset.15_3 = offset;
  if (offset.15_3 != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _4 = outpkt->pbuf;
  len = mdns_compress_domain (_4, &offset, domain);
  # DEBUG BEGIN_STMT
  if (len < writelen)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  writelen = len;
  # DEBUG BEGIN_STMT
  jump_offset = offset;

  <bb 7> :
  offset = {CLOBBER};
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 8> :
  # DEBUG BEGIN_STMT
  if (i <= 9)
    goto <bb 4>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  if (writelen != 0)
    goto <bb 10>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  _5 = outpkt->pbuf;
  _6 = &domain->name;
  _7 = outpkt->write_offset;
  res = pbuf_take_at (_5, _6, writelen, _7);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8060 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 16>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  _8 = outpkt->domain_offsets[i];
  if (_8 == 0)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  _9 = outpkt->write_offset;
  outpkt->domain_offsets[i] = _9;
  # DEBUG BEGIN_STMT
  goto <bb 17>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 16> :
  # DEBUG BEGIN_STMT
  if (i <= 9)
    goto <bb 13>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  _10 = outpkt->write_offset;
  _11 = writelen + _10;
  outpkt->write_offset = _11;

  <bb 18> :
  # DEBUG BEGIN_STMT
  if (jump_offset != 0)
    goto <bb 19>; [INV]
  else
    goto <bb 22>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  _12 = jump_offset | 49152;
  _13 = lwip_htons (_12);
  jump = _13;
  # DEBUG BEGIN_STMT
  _14 = outpkt->pbuf;
  _15 = outpkt->write_offset;
  res = pbuf_take_at (_14, &jump, 2, _15);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 20>; [INV]
  else
    goto <bb 21>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  D.8060 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  _16 = outpkt->write_offset;
  _17 = _16 + 2;
  outpkt->write_offset = _17;

  <bb 22> :
  # DEBUG BEGIN_STMT
  D.8060 = 0;

  <bb 23> :
  jump = {CLOBBER};
  return D.8060;

}


mdns_compress_domain (struct pbuf * pbuf, u16_t * offset, struct mdns_domain * domain)
{
  u8_t targetpos;
  u8_t labellen;
  u8_t domainlen;
  u8_t * ptr;
  u8_t writelen;
  u8_t target_len;
  u16_t target_end;
  struct mdns_domain target;
  u16_t D.7943;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  writelen = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (pbuf == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7943 = domain->length;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  _1 = *offset;
  target_end = mdns_readname (pbuf, _1, &target);
  # DEBUG BEGIN_STMT
  if (target_end == 65535)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.7943 = domain->length;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _2 = (unsigned char) target_end;
  _3 = *offset;
  _4 = (unsigned char) _3;
  target_len = _2 - _4;
  # DEBUG BEGIN_STMT
  ptr = &domain->name;
  # DEBUG BEGIN_STMT
  goto <bb 14>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _5 = domain->length;
  _6 = (unsigned char) _5;
  domainlen = _6 - writelen;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _7 = (short unsigned int) domainlen;
  _8 = target.length;
  if (_7 <= _8)
    goto <bb 8>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 8> :
  if (domainlen > 2)
    goto <bb 9>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _9 = target.length;
  _10 = (unsigned char) _9;
  targetpos = _10 - domainlen;
  # DEBUG BEGIN_STMT
  _11 = (int) targetpos;
  _12 = _11 + 2;
  _13 = (int) target_len;
  if (_12 >= _13)
    goto <bb 15>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  _14 = target.length;
  _15 = (short unsigned int) domainlen;
  if (_14 >= _15)
    goto <bb 11>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 11> :
  _16 = (int) writelen;
  _17 = &domain->name[_16];
  _18 = (int) targetpos;
  _19 = &target.name[_18];
  _20 = (unsigned int) domainlen;
  _21 = memcmp (_17, _19, _20);
  if (_21 == 0)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  _22 = *offset;
  _23 = (short unsigned int) targetpos;
  _24 = _22 + _23;
  *offset = _24;
  # DEBUG BEGIN_STMT
  D.7943 = (u16_t) writelen;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 16>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  labellen = *ptr;
  # DEBUG BEGIN_STMT
  _25 = labellen + writelen;
  writelen = _25 + 1;
  # DEBUG BEGIN_STMT
  _26 = (int) labellen;
  _27 = _26 + 1;
  _28 = (sizetype) _27;
  ptr = ptr + _28;

  <bb 14> :
  # DEBUG BEGIN_STMT
  _29 = (short unsigned int) writelen;
  _30 = domain->length;
  if (_29 < _30)
    goto <bb 7>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  D.7943 = domain->length;

  <bb 16> :
  target = {CLOBBER};
  return D.7943;

}


check_service (struct mdns_service * service, struct mdns_rr_info * rr)
{
  struct mdns_domain mydomain;
  int replies;
  err_t res;
  int D.8584;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  replies = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = rr->klass;
  if (_1 != 1)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 3> :
  _2 = rr->klass;
  if (_2 != 255)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8584 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 24>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  res = mdns_build_dnssd_domain (&mydomain);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 6>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 6> :
  _3 = &rr->domain;
  _4 = mdns_domain_eq (_3, &mydomain);
  if (_4 != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 7> :
  _5 = rr->type;
  if (_5 == 12)
    goto <bb 9>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 8> :
  _6 = rr->type;
  if (_6 == 255)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  replies = replies | 16;

  <bb 10> :
  # DEBUG BEGIN_STMT
  res = mdns_build_service_domain (&mydomain, service, 0);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 11>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 11> :
  _7 = &rr->domain;
  _8 = mdns_domain_eq (_7, &mydomain);
  if (_8 != 0)
    goto <bb 12>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 12> :
  _9 = rr->type;
  if (_9 == 12)
    goto <bb 14>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 13> :
  _10 = rr->type;
  if (_10 == 255)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  replies = replies | 32;

  <bb 15> :
  # DEBUG BEGIN_STMT
  res = mdns_build_service_domain (&mydomain, service, 1);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 16>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 16> :
  _11 = &rr->domain;
  _12 = mdns_domain_eq (_11, &mydomain);
  if (_12 != 0)
    goto <bb 17>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  _13 = rr->type;
  if (_13 == 33)
    goto <bb 19>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 18> :
  _14 = rr->type;
  if (_14 == 255)
    goto <bb 19>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  replies = replies | 64;

  <bb 20> :
  # DEBUG BEGIN_STMT
  _15 = rr->type;
  if (_15 == 16)
    goto <bb 22>; [INV]
  else
    goto <bb 21>; [INV]

  <bb 21> :
  _16 = rr->type;
  if (_16 == 255)
    goto <bb 22>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  replies = replies | 128;

  <bb 23> :
  # DEBUG BEGIN_STMT
  D.8584 = replies;

  <bb 24> :
  mydomain = {CLOBBER};
  return D.8584;

}


check_host (struct netif * netif, struct mdns_rr_info * rr, u8_t * reverse_v6_reply)
{
  int i;
  struct mdns_domain mydomain;
  int replies;
  err_t res;
  int D.8548;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  replies = 0;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = rr->klass;
  if (_1 != 1)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 3> :
  _2 = rr->klass;
  if (_2 != 255)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8548 = replies;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 29>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _3 = rr->type;
  if (_3 == 12)
    goto <bb 7>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 6> :
  _4 = rr->type;
  if (_4 == 255)
    goto <bb 7>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 14>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  _5 = netif->ip6_addr_state[i];
  _6 = (int) _5;
  _7 = _6 & 16;
  if (_7 != 0)
    goto <bb 9>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _8 = &netif->ip6_addr[i].u_addr.ip6;
  res = mdns_build_reverse_v6_domain (&mydomain, _8);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 10>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 10> :
  _9 = &rr->domain;
  _10 = mdns_domain_eq (_9, &mydomain);
  if (_10 != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  replies = replies | 8;
  # DEBUG BEGIN_STMT
  if (reverse_v6_reply != 0B)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  _11 = *reverse_v6_reply;
  _12 = (signed char) _11;
  _13 = 1 << i;
  _14 = (signed char) _13;
  _15 = _12 | _14;
  _16 = (unsigned char) _15;
  *reverse_v6_reply = _16;

  <bb 13> :
  # DEBUG BEGIN_STMT
  i = i + 1;

  <bb 14> :
  # DEBUG BEGIN_STMT
  if (i <= 2)
    goto <bb 8>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  _17 = &netif->ip_addr.u_addr.ip4;
  _18 = MEM[(const struct ip4_addr_t *)_17].addr;
  if (_18 != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  _19 = &netif->ip_addr.u_addr.ip4;
  res = mdns_build_reverse_v4_domain (&mydomain, _19);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 17>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 17> :
  _20 = &rr->domain;
  _21 = mdns_domain_eq (_20, &mydomain);
  if (_21 != 0)
    goto <bb 18>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  replies = replies | 2;

  <bb 19> :
  # DEBUG BEGIN_STMT
  mdns_netif_client_id.75_22 = mdns_netif_client_id;
  _23 = (int) mdns_netif_client_id.75_22;
  _24 = netif->client_data[_23];
  res = mdns_build_host_domain (&mydomain, _24);
  # DEBUG BEGIN_STMT
  if (res == 0)
    goto <bb 20>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 20> :
  _25 = &rr->domain;
  _26 = mdns_domain_eq (_25, &mydomain);
  if (_26 != 0)
    goto <bb 21>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  _27 = &netif->ip_addr.u_addr.ip4;
  _28 = MEM[(const struct ip4_addr_t *)_27].addr;
  if (_28 != 0)
    goto <bb 22>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 22> :
  _29 = rr->type;
  if (_29 == 1)
    goto <bb 24>; [INV]
  else
    goto <bb 23>; [INV]

  <bb 23> :
  _30 = rr->type;
  if (_30 == 255)
    goto <bb 24>; [INV]
  else
    goto <bb 25>; [INV]

  <bb 24> :
  # DEBUG BEGIN_STMT
  replies = replies | 1;

  <bb 25> :
  # DEBUG BEGIN_STMT
  _31 = rr->type;
  if (_31 == 28)
    goto <bb 27>; [INV]
  else
    goto <bb 26>; [INV]

  <bb 26> :
  _32 = rr->type;
  if (_32 == 255)
    goto <bb 27>; [INV]
  else
    goto <bb 28>; [INV]

  <bb 27> :
  # DEBUG BEGIN_STMT
  replies = replies | 4;

  <bb 28> :
  # DEBUG BEGIN_STMT
  D.8548 = replies;

  <bb 29> :
  mydomain = {CLOBBER};
  return D.8548;

}


mdns_build_service_domain (struct mdns_domain * domain, struct mdns_service * service, int include_name)
{
  err_t res;
  err_t D.8027;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  if (include_name != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  _1 = &service->name;
  _2 = &service->name;
  _3 = strlen (_2);
  _4 = (unsigned char) _3;
  res = mdns_domain_add_label (domain, _1, _4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8027 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 10>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _5 = &service->service;
  _6 = &service->service;
  _7 = strlen (_6);
  _8 = (unsigned char) _7;
  res = mdns_domain_add_label (domain, _5, _8);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.8027 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 10>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _9 = service->proto;
  _10 = (int) _9;
  _11 = dnssd_protos[_10];
  _12 = service->proto;
  _13 = (int) _12;
  _14 = dnssd_protos[_13];
  _15 = strlen (_14);
  _16 = (unsigned char) _15;
  res = mdns_domain_add_label (domain, _11, _16);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  D.8027 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8027 = mdns_add_dotlocal (domain);

  <bb 10> :
  return D.8027;

}


mdns_build_dnssd_domain (struct mdns_domain * domain)
{
  err_t res;
  err_t D.8216;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "_services", 9);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8216 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "_dns-sd", 7);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8216 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = dnssd_protos[0];
  _2 = dnssd_protos[0];
  _3 = strlen (_2);
  _4 = (unsigned char) _3;
  res = mdns_domain_add_label (domain, _1, _4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8216 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8216 = mdns_add_dotlocal (domain);

  <bb 9> :
  return D.8216;

}


mdns_build_host_domain (struct mdns_domain * domain, struct mdns_host * mdns)
{
  err_t res;
  err_t D.8015;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (mdns == 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8015 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = &mdns->name;
  _2 = &mdns->name;
  _3 = strlen (_2);
  _4 = (unsigned char) _3;
  res = mdns_domain_add_label (domain, _1, _4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  D.8015 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8015 = mdns_add_dotlocal (domain);

  <bb 7> :
  return D.8015;

}


mdns_add_dotlocal (struct mdns_domain * domain)
{
  err_t res;
  err_t D.8021;

  <bb 2> :
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "local", 5);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.8021 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8021 = mdns_domain_add_label (domain, 0B, 0);

  <bb 5> :
  return D.8021;

}


mdns_build_reverse_v6_domain (struct mdns_domain * domain, const struct ip6_addr_t * addr)
{
  int j;
  u8_t byte;
  char buf;
  const u8_t * ptr;
  err_t res;
  int i;
  err_t D.8196;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (domain == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 3>; [INV]

  <bb 3> :
  if (addr == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8196 = -16;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  ptr = addr;
  # DEBUG BEGIN_STMT
  i = 15;
  goto <bb 15>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  i.33_1 = (sizetype) i;
  _2 = ptr + i.33_1;
  byte = *_2;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  j = 0;
  goto <bb 13>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _3 = (int) byte;
  _4 = _3 & 15;
  if (_4 <= 9)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  _5 = byte & 15;
  _6 = _5 + 48;
  buf = _6;
  goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _7 = byte & 15;
  _8 = _7 + 87;
  buf = _8;

  <bb 10> :
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, &buf, 1);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8196 = res;
  // predicted unlikely by early return (on trees) predictor.
  buf = {CLOBBER};
  goto <bb 23>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  byte = byte >> 4;
  # DEBUG BEGIN_STMT
  j = j + 1;

  <bb 13> :
  # DEBUG BEGIN_STMT
  if (j <= 1)
    goto <bb 7>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 14> :
  buf = {CLOBBER};
  # DEBUG BEGIN_STMT
  i = i + -1;

  <bb 15> :
  # DEBUG BEGIN_STMT
  if (i >= 0)
    goto <bb 6>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "ip6", 3);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 17>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  D.8196 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "arpa", 4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 19>; [INV]
  else
    goto <bb 20>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  D.8196 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 20> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, 0B, 0);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 21>; [INV]
  else
    goto <bb 22>; [INV]

  <bb 21> :
  # DEBUG BEGIN_STMT
  D.8196 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 23>; [INV]

  <bb 22> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8196 = 0;

  <bb 23> :
  return D.8196;

}


mdns_build_reverse_v4_domain (struct mdns_domain * domain, const struct ip4_addr_t * addr)
{
  u8_t val;
  char buf[4];
  const u8_t * ptr;
  err_t res;
  int i;
  err_t D.8155;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (domain == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 3>; [INV]

  <bb 3> :
  if (addr == 0B)
    goto <bb 4>; [INV]
  else
    goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  D.8155 = -16;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  ptr = addr;
  # DEBUG BEGIN_STMT
  i = 3;
  goto <bb 9>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  i.30_1 = (sizetype) i;
  _2 = ptr + i.30_1;
  val = *_2;
  # DEBUG BEGIN_STMT
  _3 = (int) val;
  lwip_itoa (&buf, 4, _3);
  # DEBUG BEGIN_STMT
  _4 = strlen (&buf);
  _5 = (unsigned char) _4;
  res = mdns_domain_add_label (domain, &buf, _5);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 7>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  D.8155 = res;
  // predicted unlikely by early return (on trees) predictor.
  buf = {CLOBBER};
  goto <bb 17>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  buf = {CLOBBER};
  # DEBUG BEGIN_STMT
  i = i + -1;

  <bb 9> :
  # DEBUG BEGIN_STMT
  if (i >= 0)
    goto <bb 6>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "in-addr", 7);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.8155 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, "arpa", 4);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 13>; [INV]
  else
    goto <bb 14>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  D.8155 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label (domain, 0B, 0);
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 15>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  D.8155 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  D.8155 = 0;

  <bb 17> :
  return D.8155;

}


mdns_prepare_txtdata (struct mdns_service * service)
{
  <bb 2> :
  # DEBUG BEGIN_STMT
  _1 = &service->txtdata;
  memset (_1, 0, 260);
  # DEBUG BEGIN_STMT
  _2 = service->txt_fn;
  if (_2 != 0B)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  _3 = service->txt_fn;
  _4 = service->txt_userdata;
  _3 (service, _4);

  <bb 4> :
  return;

}


mdns_domain_eq (struct mdns_domain * a, struct mdns_domain * b)
{
  int res;
  u8_t len;
  u8_t * ptrb;
  u8_t * ptra;
  int D.7929;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _1 = a->length;
  _2 = b->length;
  if (_1 != _2)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7929 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  ptra = &a->name;
  # DEBUG BEGIN_STMT
  ptrb = &b->name;
  # DEBUG BEGIN_STMT
  goto <bb 10>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _3 = *ptra;
  _4 = *ptrb;
  if (_3 != _4)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.7929 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  len = *ptra;
  # DEBUG BEGIN_STMT
  ptra = ptra + 1;
  # DEBUG BEGIN_STMT
  ptrb = ptrb + 1;
  # DEBUG BEGIN_STMT
  _5 = (unsigned int) len;
  res = lwip_strnicmp (ptra, ptrb, _5);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 8>; [INV]
  else
    goto <bb 9>; [INV]

  <bb 8> :
  # DEBUG BEGIN_STMT
  D.7929 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  _6 = (sizetype) len;
  ptra = ptra + _6;
  # DEBUG BEGIN_STMT
  _7 = (sizetype) len;
  ptrb = ptrb + _7;

  <bb 10> :
  # DEBUG BEGIN_STMT
  _8 = *ptra;
  if (_8 != 0)
    goto <bb 11>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 11> :
  _9 = *ptrb;
  if (_9 != 0)
    goto <bb 12>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 12> :
  _10 = a->length;
  _11 = (int) _10;
  _12 = &a->name[_11];
  if (ptra < _12)
    goto <bb 5>; [INV]
  else
    goto <bb 13>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  _13 = *ptra;
  _14 = *ptrb;
  if (_13 != _14)
    goto <bb 14>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 14> :
  _15 = a->length;
  _16 = (int) _15;
  _17 = &a->name[_16];
  if (ptra < _17)
    goto <bb 15>; [INV]
  else
    goto <bb 16>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  D.7929 = 0;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  D.7929 = 1;

  <bb 17> :
  return D.7929;

}


mdns_domain_debug_print (struct mdns_domain * domain)
{
  u8_t label_len;
  u8_t i;
  u8_t * src;

  <bb 2> :
  # DEBUG BEGIN_STMT
  src = &domain->name;
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  goto <bb 7>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  label_len = *src;
  # DEBUG BEGIN_STMT
  src = src + 1;
  # DEBUG BEGIN_STMT
  i = 0;
  goto <bb 5>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  i.68_1 = i;
  i = i.68_1 + 1;

  <bb 5> :
  # DEBUG BEGIN_STMT
  if (i < label_len)
    goto <bb 4>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _2 = (sizetype) label_len;
  src = src + _2;

  <bb 7> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _3 = *src;
  if (_3 != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 8> :
  return;

}


mdns_readname (struct pbuf * p, u16_t offset, struct mdns_domain * domain)
{
  u16_t D.7896;

  <bb 2> :
  # DEBUG BEGIN_STMT
  memset (domain, 0, 260);
  # DEBUG BEGIN_STMT
  D.7896 = mdns_readname_loop (p, offset, domain, 0);
  return D.7896;

}


mdns_readname_loop (struct pbuf * p, u16_t offset, struct mdns_domain * domain, unsigned int depth)
{
  err_t res;
  u16_t res;
  u16_t jumpaddr;
  u8_t c;
  u16_t D.7900;

  <bb 2> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  if (depth > 5)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  c = pbuf_get_at (p, offset);
  # DEBUG BEGIN_STMT
  offset.0_1 = offset;
  offset = offset.0_1 + 1;
  # DEBUG BEGIN_STMT
  _2 = (int) c;
  _3 = _2 & 192;
  if (_3 == 192)
    goto <bb 5>; [INV]
  else
    goto <bb 12>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _4 = p->tot_len;
  if (offset >= _4)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _5 = (int) c;
  _6 = _5 << 8;
  _7 = (signed short) _6;
  _8 = _7 & 16128;
  _9 = pbuf_get_at (p, offset);
  _10 = (signed short) _9;
  _11 = _8 | _10;
  jumpaddr = (u16_t) _11;
  # DEBUG BEGIN_STMT
  offset.1_12 = offset;
  offset = offset.1_12 + 1;
  # DEBUG BEGIN_STMT
  if (jumpaddr > 11)
    goto <bb 8>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 8> :
  _13 = p->tot_len;
  if (jumpaddr < _13)
    goto <bb 9>; [INV]
  else
    goto <bb 11>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _14 = depth + 1;
  res = mdns_readname_loop (p, jumpaddr, domain, _14);
  # DEBUG BEGIN_STMT
  if (res == 65535)
    goto <bb 10>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  D.7900 = res;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 11> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 12> :
  # DEBUG BEGIN_STMT
  if (c <= 63)
    goto <bb 13>; [INV]
  else
    goto <bb 18>; [INV]

  <bb 13> :
  # DEBUG BEGIN_STMT
  # DEBUG BEGIN_STMT
  _15 = (int) c;
  _16 = domain->length;
  _17 = (int) _16;
  _18 = _15 + _17;
  if (_18 > 255)
    goto <bb 14>; [INV]
  else
    goto <bb 15>; [INV]

  <bb 14> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 15> :
  # DEBUG BEGIN_STMT
  res = mdns_domain_add_label_pbuf (domain, p, offset, c);
  # DEBUG BEGIN_STMT
  if (res != 0)
    goto <bb 16>; [INV]
  else
    goto <bb 17>; [INV]

  <bb 16> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 17> :
  # DEBUG BEGIN_STMT
  _19 = (short unsigned int) c;
  offset = offset + _19;
  # DEBUG BEGIN_STMT
  if (c != 0)
    goto <bb 2>; [INV]
  else
    goto <bb 19>; [INV]

  <bb 18> :
  # DEBUG BEGIN_STMT
  D.7900 = 65535;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 20>; [INV]

  <bb 19> :
  # DEBUG BEGIN_STMT
  D.7900 = offset;

  <bb 20> :
  return D.7900;

}


mdns_domain_add_label_pbuf (struct mdns_domain * domain, const struct pbuf * p, u16_t offset, u8_t len)
{
  err_t err;
  err_t D.7921;

  <bb 2> :
  # DEBUG BEGIN_STMT
  err = mdns_domain_add_label_base (domain, len);
  # DEBUG BEGIN_STMT
  if (err != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7921 = err;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  if (len != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 8>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _1 = domain->length;
  _2 = (int) _1;
  _3 = &domain->name[_2];
  _4 = (short unsigned int) len;
  _5 = pbuf_copy_partial (p, _3, _4, offset);
  _6 = (short unsigned int) len;
  if (_5 != _6)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  _7 = domain->length;
  _8 = _7;
  _9 = _8 + 65535;
  domain->length = _9;
  # DEBUG BEGIN_STMT
  D.7921 = -16;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 9>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  _10 = domain->length;
  _11 = (short unsigned int) len;
  _12 = _10 + _11;
  domain->length = _12;

  <bb 8> :
  # DEBUG BEGIN_STMT
  D.7921 = 0;

  <bb 9> :
  return D.7921;

}


mdns_domain_add_label (struct mdns_domain * domain, const char * label, u8_t len)
{
  err_t err;
  err_t D.7880;

  <bb 2> :
  # DEBUG BEGIN_STMT
  err = mdns_domain_add_label_base (domain, len);
  # DEBUG BEGIN_STMT
  if (err != 0)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7880 = err;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 7>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  if (len != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 6>; [INV]

  <bb 5> :
  # DEBUG BEGIN_STMT
  _1 = domain->length;
  _2 = (int) _1;
  _3 = &domain->name[_2];
  _4 = (unsigned int) len;
  memcpy (_3, label, _4);
  # DEBUG BEGIN_STMT
  _5 = domain->length;
  _6 = (short unsigned int) len;
  _7 = _5 + _6;
  domain->length = _7;

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.7880 = 0;

  <bb 7> :
  return D.7880;

}


mdns_domain_add_label_base (struct mdns_domain * domain, u8_t len)
{
  err_t D.7886;

  <bb 2> :
  # DEBUG BEGIN_STMT
  if (len > 63)
    goto <bb 3>; [INV]
  else
    goto <bb 4>; [INV]

  <bb 3> :
  # DEBUG BEGIN_STMT
  D.7886 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 4> :
  # DEBUG BEGIN_STMT
  if (len != 0)
    goto <bb 5>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 5> :
  _1 = (int) len;
  _2 = _1 + 1;
  _3 = domain->length;
  _4 = (int) _3;
  _5 = _2 + _4;
  if (_5 > 255)
    goto <bb 6>; [INV]
  else
    goto <bb 7>; [INV]

  <bb 6> :
  # DEBUG BEGIN_STMT
  D.7886 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 7> :
  # DEBUG BEGIN_STMT
  if (len == 0)
    goto <bb 8>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 8> :
  _6 = domain->length;
  if (_6 > 255)
    goto <bb 9>; [INV]
  else
    goto <bb 10>; [INV]

  <bb 9> :
  # DEBUG BEGIN_STMT
  D.7886 = -6;
  // predicted unlikely by early return (on trees) predictor.
  goto <bb 11>; [INV]

  <bb 10> :
  # DEBUG BEGIN_STMT
  _7 = domain->length;
  _8 = (int) _7;
  domain->name[_8] = len;
  # DEBUG BEGIN_STMT
  _9 = domain->length;
  _10 = _9;
  _11 = _10 + 1;
  domain->length = _11;
  # DEBUG BEGIN_STMT
  D.7886 = 0;

  <bb 11> :
  return D.7886;

}


